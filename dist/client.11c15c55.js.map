{"version":3,"sources":["D:\\Projects\\konachan_mirror\\client.11c15c55.js","webpack:///./client/components/header.vue?f38e","D:\\Projects\\konachan_mirror\\client\\config.js","D:\\Projects\\konachan_mirror\\client\\index.js","D:\\Projects\\konachan_mirror\\client\\promise-polyfill.js","D:\\Projects\\konachan_mirror\\client\\app.js","webpack:///./client/components/App.vue?4a8d","D:\\Projects\\konachan_mirror\\client\\components\\App.vue","D:\\Projects\\konachan_mirror\\client\\components\\header.vue","webpack:///./client/components/header.vue?0cfd","webpack:///./client/components/App.vue?48de","D:\\Projects\\konachan_mirror\\client\\router\\index.js","webpack:///./client/views/post.vue?b62c","D:\\Projects\\konachan_mirror\\client\\views\\post.vue","webpack:///./node_modules/vue-waterfall/lib/waterfall.vue?bf02","D:\\Projects\\konachan_mirror\\node_modules\\vue-waterfall\\lib\\waterfall.vue","webpack:///./node_modules/vue-waterfall/lib/waterfall.vue?b155","webpack:///./node_modules/vue-waterfall/lib/waterfall-slot.vue?bf15","D:\\Projects\\konachan_mirror\\node_modules\\vue-waterfall\\lib\\waterfall-slot.vue","webpack:///./node_modules/vue-waterfall/lib/waterfall-slot.vue?a50b","webpack:///./client/components/waterfallImage.vue?aac5","D:\\Projects\\konachan_mirror\\client\\components\\waterfallImage.vue","webpack:///./client/components/waterfallImage.vue?4b5f","webpack:///./client/views/post.vue?13f2","webpack:///./client/views/image.vue?343d","D:\\Projects\\konachan_mirror\\client\\views\\image.vue","webpack:///./client/views/image.vue?afb5","webpack:///./client/views/error.vue?1865","D:\\Projects\\konachan_mirror\\client\\views\\error.vue","webpack:///./client/views/error.vue?afb4","D:\\Projects\\konachan_mirror\\client\\store\\index.js","D:\\Projects\\konachan_mirror\\client\\pwa.js"],"names":["webpackJsonp","module","__webpack_exports__","__webpack_require__","injectStyle","ssrContext","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_header_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4c15fbea_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_header_vue__","normalizeComponent","__vue_styles__","Component","requestURI","postList","image","comment","methods","getPostListURI","_ref","tags","page","replace","getImageURI","_ref2","id","getCommentURI","_ref3","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_1__app__","$mount","__WEBPACK_IMPORTED_MODULE_0_promise_polyfill__","__WEBPACK_IMPORTED_MODULE_0_promise_polyfill___default","n","window","Promise","a","d","app","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_1_vuex_router_sync__","__WEBPACK_IMPORTED_MODULE_2__components_App__","__WEBPACK_IMPORTED_MODULE_3__router__","__WEBPACK_IMPORTED_MODULE_4__store__","assign","router","store","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_App_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_ab4e3618_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_App_vue__","exports","__WEBPACK_IMPORTED_MODULE_0__header__","components","headerbar","__WEBPACK_IMPORTED_MODULE_0_lodash__","__WEBPACK_IMPORTED_MODULE_0_lodash___default","name","props","query","type","Array","default","rating","String","data","iquery","this","irating","queryStr","remove","v","test","join","isErr","computed","isSafeMode","watch","without","split","console","log","length","searchQueryChanged","submitQuery","event","$emit","render","_vm","_h","$createElement","_c","_self","staticClass","directives","rawName","expression","class","err","attrs","placeholder","domProps","on","keypress","$event","_k","keyCode","key","change","input","target","composing","_v","staticRenderFns","esExports","keep-alive","__WEBPACK_IMPORTED_MODULE_1_vue_router__","__WEBPACK_IMPORTED_MODULE_2__views_post__","__WEBPACK_IMPORTED_MODULE_3__views_image__","__WEBPACK_IMPORTED_MODULE_4__views_error__","use","mode","routes","path","component","route","startPage","parseInt","startTags","decodeURIComponent","params","number","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_post_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_f93712e6_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_post_vue__","__WEBPACK_IMPORTED_MODULE_0__components_header__","__WEBPACK_IMPORTED_MODULE_1_vue_waterfall_lib_waterfall__","__WEBPACK_IMPORTED_MODULE_2_vue_waterfall_lib_waterfall_slot__","__WEBPACK_IMPORTED_MODULE_3__components_waterfallImage__","mirrorRoot","Number","startRatingFlag","Waterfall","WaterfallSlot","waterfallImage","scrollMargin","isBusy","$store","state","busyState","reachingEnd","notError","errorState","errorMsg","imgsArr","get","set","commit","created","mounted","_this","$route","getPosts","addEventListener","checkScrollingAndCallUpdate","$refs","waterfall","$nextTick","scrollPosition","document","documentElement","scrollTop","beforeRouteLeave","to","from","next","removeEventListener","querySubmission","$router","push","getters","queryTags","body","innerHeight","clientHeight","loadNextPage","refresh","arguments","undefined","dispatch","callback","calcHeight","item","isPageInd","preview_height","updateHeight","args","index","height","$forceUpdate","__WEBPACK_IMPORTED_MODULE_0__babel_loader_vue_loader_lib_selector_type_script_index_0_waterfall_vue__","__WEBPACK_IMPORTED_MODULE_1__vue_loader_lib_template_compiler_index_id_data_v_09ced947_hasScoped_false_buble_transforms_vue_loader_lib_selector_type_template_index_0_waterfall_vue__","autoResizeHandler","autoResize","reflowHandler","off","tidyUpAnimations","node","moveClass","MOVE_CLASS_PROP","removeClass","clearTimeout","token","setTimeout","reflow","interval","_this2","$el","width","clientWidth","metas","$children","map","slot","getMeta","sort","b","order","virtualRects","calculate","isScrollBarVisibilityChange","style","overflow","el","lastClientWidth","vm","styles","options","getOptions","line","horizontalLineProcessor","verticalLineProcessor","maxLineGap","lineGap","align","indexOf","minLineGap","singleMaxWidth","Math","max","fixedHeight","grow","val","getLeft","contentWidth","sum","arr","reduce","rects","metasNeedToMoveByTransform","filter","meta","firstRects","getRects","applyRects","lastRects","forEach","i","setTransform","addClass","clearTransform","rect","prop","firstRect","lastRect","dx","left","dy","top","sw","sh","transform","WebkitTransform","transitionDuration","getTransitionEndEvent","ontransitionend","onwebkittransitionend","getArrayFillWith","count","getter","elem","hasClass","attr","trim","reg","RegExp","getAttribute","setAttribute","listener","useCapture","validator","required","$on","$watch","beforeDestroy","strategy","getRowStrategyWithGrow","getRowStrategy","tops","offset","last","slice","apply","slotWidth","maxContentWidth","minGreedyContentWidth","canFit","canFitGreedy","round","min","total","greedyCount","getGreedyCount","lazyCount","greedySize","getContentSize","lazySize","finalSize","chooseFinalSize","fitContentWidth","rowWidth","rowHeight","originWidth","fitHeight","cost","abs","Infinity","_t","__WEBPACK_IMPORTED_MODULE_0__babel_loader_vue_loader_lib_selector_type_script_index_0_waterfall_slot_vue__","__WEBPACK_IMPORTED_MODULE_1__vue_loader_lib_template_compiler_index_id_data_v_1b429f74_hasScoped_false_buble_transforms_vue_loader_lib_selector_type_template_index_0_waterfall_slot_vue__","isShow","notify","$parent","$once","destroyed","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_waterfallImage_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_e1d6dc74_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_waterfallImage_vue__","author","created_at","source","score","file_size","file_url","preview_url","actual_preview_width","actual_preview_height","sample_url","sample_width","sample_height","sample_file_size","jpeg_url","jpeg_file_size","Boolean","onHover","loaded","hover","onHoverOff","recalculateHeight","wrapper","offsetHeight","placeholderStyle","tagsArr","ceil","getComputedStyle","marginBottom","appear","ref","mouseover","mouseout","_s","_e","src","alt","loadend","click","_l","tag","ratingFlag","line-gap","realHeight","move-class","_b","height-change","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_image_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_401025be_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_image_vue__","__WEBPACK_IMPORTED_MODULE_1__config_js__","updateData","imageInfo","comments","hasJpegVariant","fetchImageData","request","XMLHttpRequest","onreadystatechange","readyState","DONE","status","responseObject","JSON","parse","responseText","open","send","fetchCommentData","regulateComment","href","download","toFixed","creator","__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_error_vue__","__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_efe7a02a_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_error_vue__","_toConsumableArray","isArray","arr2","__WEBPACK_IMPORTED_MODULE_1_vuex__","__WEBPACK_IMPORTED_MODULE_2__config_js__","mutations","resetImageArr","appendImageArr","newArr","setPage","nextPage","resetPage","setTags","commitRealHeight","resetStates","recvError","reachEnd","setBusy","busy","setScroll","scroll","actions","context","_ref2$nextPage","_ref2$rating","_ref2$callback","_ref2$callbackArgs","callbackArgs","success","_","unshift","reason","Store","__WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime__","__WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime___default","install","onUpdateReady","applyUpdate","onUpdated","location","reload"],"mappings":"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","file":"client.11c15c55.js","sourcesContent":["webpackJsonp([0],[\n/* 0 */,\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */\n/*!**************************************!*\\\n  !*** ./client/components/header.vue ***!\n  \\**************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_header_vue__ = __webpack_require__(/*! !babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./header.vue */ 19);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4c15fbea_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_header_vue__ = __webpack_require__(/*! !../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-4c15fbea\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./header.vue */ 21);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-4c15fbea\",\"scoped\":true,\"hasInlineConfig\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./header.vue */ 18)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../node_modules/vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4c15fbea\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_header_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4c15fbea_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_header_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 5 */,\n/* 6 */\n/*!**************************!*\\\n  !*** ./client/config.js ***!\n  \\**************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar requestURI = {\n  postList: \"https://konachan.kcsl.ink/kona-api/post.json?tags=__TAGS__&page=__PAGE__\",\n  image: \"https://konachan.kcsl.ink/kona-api/post.json?tags=id:__ID__\",\n  comment: \"https://konachan.kcsl.ink/kona-api/comment.json?post_id=__ID__\"\n};\n\nvar methods = {\n  getPostListURI: function getPostListURI(_ref) {\n    var tags = _ref.tags,\n        page = _ref.page;\n\n    return requestURI.postList.replace(\"__TAGS__\", tags).replace(\"__PAGE__\", page);\n  },\n  getImageURI: function getImageURI(_ref2) {\n    var id = _ref2.id;\n\n    return requestURI.image.replace(\"__ID__\", id);\n  },\n  getCommentURI: function getCommentURI(_ref3) {\n    var id = _ref3.id;\n\n    return requestURI.comment.replace(\"__ID__\", id);\n  }\n};\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  requestURI: requestURI,\n  methods: methods\n});\n\n/***/ }),\n/* 7 */\n/*!*************************!*\\\n  !*** ./client/index.js ***!\n  \\*************************/\n/*! no exports provided */\n/*! all exports used */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__promise_polyfill__ = __webpack_require__(/*! ./promise-polyfill */ 8);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__app__ = __webpack_require__(/*! ./app */ 12);\n\n\n\n// Enable progressive web app support (with offline-plugin)\nif (true) {\n  __webpack_require__(/*! ./pwa */ 52);\n}\n\n__WEBPACK_IMPORTED_MODULE_1__app__[\"a\" /* app */].$mount('#app');\n\n/***/ }),\n/* 8 */\n/*!************************************!*\\\n  !*** ./client/promise-polyfill.js ***!\n  \\************************************/\n/*! no exports provided */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_promise_polyfill__ = __webpack_require__(/*! promise-polyfill */ 9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_promise_polyfill___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_promise_polyfill__);\n\n\nwindow.Promise = window.Promise || __WEBPACK_IMPORTED_MODULE_0_promise_polyfill___default.a;\n\n/***/ }),\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */\n/*!***********************!*\\\n  !*** ./client/app.js ***!\n  \\***********************/\n/*! exports provided: app, router, store */\n/*! exports used: app */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return app; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(/*! vue */ 2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vuex_router_sync__ = __webpack_require__(/*! vuex-router-sync */ 13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vuex_router_sync___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_vuex_router_sync__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__components_App__ = __webpack_require__(/*! ./components/App */ 14);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__router__ = __webpack_require__(/*! ./router */ 23);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__store__ = __webpack_require__(/*! ./store */ 50);\n/* unused harmony reexport router */\n/* unused harmony reexport store */\n\n\n\n\n\n\nObject(__WEBPACK_IMPORTED_MODULE_1_vuex_router_sync__[\"sync\"])(__WEBPACK_IMPORTED_MODULE_4__store__[\"a\" /* default */], __WEBPACK_IMPORTED_MODULE_3__router__[\"a\" /* default */]);\n\nvar app = new __WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */](Object.assign({\n  router: __WEBPACK_IMPORTED_MODULE_3__router__[\"a\" /* default */],\n  store: __WEBPACK_IMPORTED_MODULE_4__store__[\"a\" /* default */]\n}, __WEBPACK_IMPORTED_MODULE_2__components_App__[\"a\" /* default */]));\n\n\n\n/***/ }),\n/* 13 */,\n/* 14 */\n/*!***********************************!*\\\n  !*** ./client/components/App.vue ***!\n  \\***********************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_App_vue__ = __webpack_require__(/*! !babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue */ 17);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_ab4e3618_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_App_vue__ = __webpack_require__(/*! !../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-ab4e3618\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue */ 22);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-ab4e3618\",\"scoped\":false,\"hasInlineConfig\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue */ 15)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../node_modules/vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_App_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_ab4e3618_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_App_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 15 */\n/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-ab4e3618\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?sourceMap!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./client/components/App.vue ***!\n  \\*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 16 */,\n/* 17 */\n/*!*********************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./client/components/App.vue ***!\n  \\*********************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__header__ = __webpack_require__(/*! ./header */ 4);\n//\n//\n//\n//\n//\n//\n//\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  components: {\n    headerbar: __WEBPACK_IMPORTED_MODULE_0__header__[\"a\" /* default */]\n  }\n});\n\n/***/ }),\n/* 18 */\n/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-4c15fbea\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?sourceMap!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./client/components/header.vue ***!\n  \\***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 19 */\n/*!************************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./client/components/header.vue ***!\n  \\************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(/*! lodash */ 5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'headerbar',\n  props: {\n    query: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    rating: { type: String, default: 's' }\n  },\n  data: function data() {\n    return {\n      iquery: this.query || [],\n      irating: this.rating || 's',\n      queryStr: __WEBPACK_IMPORTED_MODULE_0_lodash___default.a.remove(this.iquery, function (v) {\n        return (/\\brating:\\w\\b/i.test(v)\n        );\n      }).join(' '),\n      isErr: false\n    };\n  },\n\n  computed: {\n    // queryStr: {\n    //   get() {\n    //     return _.remove(this.iquery, v => /\\brating:\\w\\b/i.test(v)).join(' ');\n    //   },\n    //   set(val) {\n    //     this.iquery = val.split(' ').unshift('rating:' + this.rating);\n    //   }\n    // // },\n    // isErr() {\n    //   return this.iquery.length > 5;\n    // },\n    isSafeMode: function isSafeMode() {\n      return this.irating == 's';\n    }\n  },\n  watch: {\n    queryStr: function queryStr() {\n      this.iquery = __WEBPACK_IMPORTED_MODULE_0_lodash___default.a.without(this.queryStr.split(' '), '');\n      this.queryStr.replace(/\\b(unsafe|safe) /i, '');\n      console.log(this.iquery);\n\n      this.isErr = this.iquery.length > 5;\n      this.irating = /\\b(rating:[^sS]|unsafe) /i.test(this.queryStr) ? 'e' : /\\b(rating:[sS]|safe) /i.test(this.queryStr) ? 's' : this.irating;\n    }\n  },\n  methods: {\n    searchQueryChanged: function searchQueryChanged() {},\n    submitQuery: function submitQuery(event) {\n      console.log('Enter key fired!');\n      console.log(event);\n      this.$emit('querySubmission', this.iquery, this.irating);\n    }\n  }\n});\n\n/***/ }),\n/* 20 */,\n/* 21 */\n/*!**************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c15fbea\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/components/header.vue ***!\n  \\**************************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"url\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.queryStr),expression:\"queryStr\"}],staticClass:\"url-text\",class:{ err: _vm.isErr },attrs:{\"id\":\"url-text\",\"type\":\"text\",\"placeholder\":\"your_tags\"},domProps:{\"value\":(_vm.queryStr)},on:{\"keypress\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key)){ return null; }_vm.submitQuery($event)},\"change\":function($event){_vm.searchQueryChanged()},\"input\":function($event){if($event.target.composing){ return; }_vm.queryStr=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"user\"})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 22 */\n/*!************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ab4e3618\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/components/App.vue ***!\n  \\************************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view',{staticClass:\"router-view\",attrs:{\"keep-alive\":\"\"}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 23 */\n/*!********************************!*\\\n  !*** ./client/router/index.js ***!\n  \\********************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(/*! vue */ 2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue_router__ = __webpack_require__(/*! vue-router */ 24);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__views_post__ = __webpack_require__(/*! ../views/post */ 25);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__views_image__ = __webpack_require__(/*! ../views/image */ 42);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__views_error__ = __webpack_require__(/*! ../views/error */ 46);\n\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].use(__WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]);\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (new __WEBPACK_IMPORTED_MODULE_1_vue_router__[\"a\" /* default */]({\n  mode: 'hash',\n  routes: [{\n    path: '/',\n    component: __WEBPACK_IMPORTED_MODULE_2__views_post__[\"a\" /* default */],\n    props: function props(route) {\n      return {\n        startPage: route.query.page ? parseInt(route.query.page) : 1,\n        startTags: route.query.tags ? decodeURIComponent(route.query.tags).split('+') : []\n      };\n    }\n  }, {\n    path: '/:id',\n    component: __WEBPACK_IMPORTED_MODULE_3__views_image__[\"a\" /* default */],\n    props: function props(route) {\n      return {\n        id: parseInt(route.params.id)\n      };\n    }\n  }, {\n    path: '/e/:number',\n    component: __WEBPACK_IMPORTED_MODULE_4__views_error__[\"a\" /* default */],\n    props: function props(route) {\n      return { number: route.params.number };\n    }\n  }]\n}));\n\n/***/ }),\n/* 24 */,\n/* 25 */\n/*!*******************************!*\\\n  !*** ./client/views/post.vue ***!\n  \\*******************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_post_vue__ = __webpack_require__(/*! !babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./post.vue */ 28);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_f93712e6_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_post_vue__ = __webpack_require__(/*! !../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-f93712e6\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./post.vue */ 41);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-f93712e6\",\"scoped\":false,\"hasInlineConfig\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./post.vue */ 26)\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-f93712e6\",\"scoped\":false,\"hasInlineConfig\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=1!./post.vue */ 27)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../node_modules/vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_post_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_f93712e6_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_post_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 26 */\n/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-f93712e6\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?sourceMap!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./client/views/post.vue ***!\n  \\*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 27 */\n/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-f93712e6\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?sourceMap!./node_modules/vue-loader/lib/selector.js?type=styles&index=1!./client/views/post.vue ***!\n  \\*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 28 */\n/*!*****************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./client/views/post.vue ***!\n  \\*****************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__components_header__ = __webpack_require__(/*! ../components/header */ 4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vue_waterfall_lib_waterfall__ = __webpack_require__(/*! vue-waterfall/lib/waterfall */ 29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_vue_waterfall_lib_waterfall_slot__ = __webpack_require__(/*! vue-waterfall/lib/waterfall-slot */ 33);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__components_waterfallImage__ = __webpack_require__(/*! ../components/waterfallImage */ 37);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'post',\n  props: {\n    mirrorRoot: String,\n    startPage: { type: Number, default: 1 },\n    startTags: { type: Array, default: [] },\n    startRatingFlag: { type: String, default: 's' }\n  },\n  components: {\n    Waterfall: __WEBPACK_IMPORTED_MODULE_1_vue_waterfall_lib_waterfall__[\"a\" /* default */],\n    WaterfallSlot: __WEBPACK_IMPORTED_MODULE_2_vue_waterfall_lib_waterfall_slot__[\"a\" /* default */],\n    headerbar: __WEBPACK_IMPORTED_MODULE_0__components_header__[\"a\" /* default */],\n    waterfallImage: __WEBPACK_IMPORTED_MODULE_3__components_waterfallImage__[\"a\" /* default */]\n  },\n  data: function data() {\n    return {\n      // imgsArr: [],\n      // page: this.startPage || 1,\n      // tags: this.startTags || [],\n      rating: 's',\n      // isBusy: true,\n      // reachingEnd: false,\n      // notError: true,\n      // errorMsg: '',\n      // config. TODO: move them out into a separate config file\n      scrollMargin: 1 // in px\n    };\n  },\n\n  computed: {\n    isBusy: function isBusy() {\n      return this.$store.state.busyState;\n    },\n    reachingEnd: function reachingEnd() {\n      return this.$store.state.reachingEnd;\n    },\n    notError: function notError() {\n      return !this.$store.state.errorState;\n    },\n    errorMsg: function errorMsg() {\n      return this.$store.state.errorMsg;\n    },\n    imgsArr: function imgsArr() {\n      return this.$store.state.imgsArr;\n    },\n    page: function page() {\n      return this.$store.state.page;\n    },\n\n    tags: {\n      get: function get() {\n        return this.$store.state.tags;\n      },\n      set: function set(v) {\n        this.$store.commit('setTags', v);\n      }\n    }\n  },\n  created: function created() {},\n  mounted: function mounted() {\n    var _this = this;\n\n    if (!this.imgsArr.length) {\n      if (this.$route.query.tags) this.$store.commit('setTags', this.$route.query.tags.split('+'));\n      this.getPosts();\n      if (this.startPage) this.$store.commit('setPage', this.startPage);\n    }\n    window.addEventListener('scroll', this.checkScrollingAndCallUpdate);\n    this.$refs.waterfall.$emit('reflow');\n    this.$nextTick(function () {\n      if (_this.$store.state.scrollPosition) document.documentElement.scrollTop = _this.$store.scrollPosition;\n    });\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    this.$store.commit('setScroll', document.documentElement.scrollTop);\n    window.removeEventListener('scroll', this.checkScrollingAndCallUpdate);\n    this.reachingEnd = false;\n    next();\n  },\n\n  watch: {\n    //   $route(t, f) {\n    //     this.reachingEnd = false;\n    //     console.log(`Redirecting from ${f} to ${t}`);\n    //     window.removeEventListener('scroll', this.checkScrollingAndCallUpdate);\n    //   }\n  },\n  methods: {\n    querySubmission: function querySubmission(tags, rating) {\n      this.rating = rating;\n      this.tags = tags;\n      this.$store.commit('resetPage');\n      this.getPosts(this.$store.state.page, true);\n      this.$router.push('/?tags=' + this.$store.getters.queryTags);\n    },\n    checkScrollingAndCallUpdate: function checkScrollingAndCallUpdate() {\n      var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n      if (scrollTop + window.innerHeight >= document.body.clientHeight - this.scrollMargin && !this.isBusy && !this.reachingEnd) {\n        this.loadNextPage();\n        // this.reflowHandler();\n      }\n    },\n    loadNextPage: function loadNextPage() {\n      if (!this.isBusy) {\n        this.$store.commit('nextPage');\n        this.getPosts(this.$store.state.page, false);\n      }\n    },\n    getPosts: function getPosts() {\n      var page = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var refresh = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n      if (this.reachingEnd) return -1;\n      if (refresh) this.$store.commit('resetImageArr');\n      this.$store.dispatch('getPosts', { refresh: refresh, rating: this.rating, callback: this.checkScrollingAndCallUpdate });\n    },\n    calcHeight: function calcHeight(item) {\n      if (!item.isPageInd) return item.preview_height + 128;else return 48;\n    },\n    updateHeight: function updateHeight(args, item, index) {\n      // Here uses an undefined behavior (?) to get the arguments\n      // TODO: use defined behavior\\\n      var height = args[0];\n      this.$store.commit('commitRealHeight', { index: index, height: height });\n      // this.$refs.waterfall.$emit('reflow');\n      this.$forceUpdate();\n    }\n  }\n});\n\n/***/ }),\n/* 29 */\n/*!******************************************************!*\\\n  !*** ./node_modules/vue-waterfall/lib/waterfall.vue ***!\n  \\******************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_vue_loader_lib_selector_type_script_index_0_waterfall_vue__ = __webpack_require__(/*! !babel-loader!../../vue-loader/lib/selector?type=script&index=0!./waterfall.vue */ 31);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vue_loader_lib_template_compiler_index_id_data_v_09ced947_hasScoped_false_buble_transforms_vue_loader_lib_selector_type_template_index_0_waterfall_vue__ = __webpack_require__(/*! !../../vue-loader/lib/template-compiler/index?{\"id\":\"data-v-09ced947\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../../vue-loader/lib/selector?type=template&index=0!./waterfall.vue */ 32);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-09ced947\",\"scoped\":false,\"hasInlineConfig\":false}!../../vue-loader/lib/selector?type=styles&index=0!./waterfall.vue */ 30)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_vue_loader_lib_selector_type_script_index_0_waterfall_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__vue_loader_lib_template_compiler_index_id_data_v_09ced947_hasScoped_false_buble_transforms_vue_loader_lib_selector_type_template_index_0_waterfall_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 30 */\n/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-09ced947\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/vue-waterfall/lib/waterfall.vue ***!\n  \\*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 31 */\n/*!****************************************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./node_modules/vue-waterfall/lib/waterfall.vue ***!\n  \\****************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nvar MOVE_CLASS_PROP = '_wfMoveClass';\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  props: {\n    autoResize: {\n      default: true\n    },\n    interval: {\n      default: 200,\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    align: {\n      default: 'left',\n      validator: function validator(val) {\n        return ~['left', 'right', 'center'].indexOf(val);\n      }\n    },\n    line: {\n      default: 'v',\n      validator: function validator(val) {\n        return ~['v', 'h'].indexOf(val);\n      }\n    },\n    lineGap: {\n      required: true,\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    minLineGap: {\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    maxLineGap: {\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    singleMaxWidth: {\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    fixedHeight: {\n      default: false\n    },\n    grow: {\n      validator: function validator(val) {\n        return val instanceof Array;\n      }\n    },\n    watch: {\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    return {\n      style: {\n        height: '',\n        overflow: ''\n      },\n      token: null\n    };\n  },\n  methods: {\n    reflowHandler: reflowHandler,\n    autoResizeHandler: autoResizeHandler,\n    reflow: reflow\n  },\n  created: function created() {\n    var _this = this;\n\n    this.virtualRects = [];\n    this.$on('reflow', function () {\n      _this.reflowHandler();\n    });\n    this.$watch(function () {\n      return _this.align, _this.line, _this.lineGap, _this.minLineGap, _this.maxLineGap, _this.singleMaxWidth, _this.fixedHeight, _this.watch;\n    }, this.reflowHandler);\n    this.$watch('grow', this.reflowHandler);\n  },\n  mounted: function mounted() {\n    this.$watch('autoResize', this.autoResizeHandler);\n    on(this.$el, getTransitionEndEvent(), tidyUpAnimations, true);\n    this.autoResizeHandler(this.autoResize);\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.autoResizeHandler(false);\n    off(this.$el, getTransitionEndEvent(), tidyUpAnimations, true);\n  }\n});\n\nfunction autoResizeHandler(autoResize) {\n  if (autoResize === false || !this.autoResize) {\n    off(window, 'resize', this.reflowHandler, false);\n  } else {\n    on(window, 'resize', this.reflowHandler, false);\n  }\n}\n\nfunction tidyUpAnimations(event) {\n  var node = event.target;\n  var moveClass = node[MOVE_CLASS_PROP];\n  if (moveClass) {\n    removeClass(node, moveClass);\n  }\n}\n\nfunction reflowHandler() {\n  clearTimeout(this.token);\n  this.token = setTimeout(this.reflow, this.interval);\n}\n\nfunction reflow() {\n  var _this2 = this;\n\n  if (!this.$el) {\n    return;\n  }\n  var width = this.$el.clientWidth;\n  var metas = this.$children.map(function (slot) {\n    return slot.getMeta();\n  });\n  metas.sort(function (a, b) {\n    return a.order - b.order;\n  });\n  this.virtualRects = metas.map(function () {\n    return {};\n  });\n  calculate(this, metas, this.virtualRects);\n  setTimeout(function () {\n    if (isScrollBarVisibilityChange(_this2.$el, width)) {\n      calculate(_this2, metas, _this2.virtualRects);\n    }\n    _this2.style.overflow = 'hidden';\n    render(_this2.virtualRects, metas);\n    _this2.$emit('reflowed', _this2);\n  }, 0);\n}\n\nfunction isScrollBarVisibilityChange(el, lastClientWidth) {\n  return lastClientWidth !== el.clientWidth;\n}\n\nfunction calculate(vm, metas, styles) {\n  var options = getOptions(vm);\n  var processor = vm.line === 'h' ? horizontalLineProcessor : verticalLineProcessor;\n  processor.calculate(vm, options, metas, styles);\n}\n\nfunction getOptions(vm) {\n  var maxLineGap = vm.maxLineGap ? +vm.maxLineGap : vm.lineGap;\n  return {\n    align: ~['left', 'right', 'center'].indexOf(vm.align) ? vm.align : 'left',\n    line: ~['v', 'h'].indexOf(vm.line) ? vm.line : 'v',\n    lineGap: +vm.lineGap,\n    minLineGap: vm.minLineGap ? +vm.minLineGap : vm.lineGap,\n    maxLineGap: maxLineGap,\n    singleMaxWidth: Math.max(vm.singleMaxWidth || 0, maxLineGap),\n    fixedHeight: !!vm.fixedHeight,\n    grow: vm.grow && vm.grow.map(function (val) {\n      return +val;\n    })\n  };\n}\n\nvar verticalLineProcessor = function () {\n\n  function calculate(vm, options, metas, rects) {\n    var width = vm.$el.clientWidth;\n    var grow = options.grow;\n    var strategy = grow ? getRowStrategyWithGrow(width, grow) : getRowStrategy(width, options);\n    var tops = getArrayFillWith(0, strategy.count);\n    metas.forEach(function (meta, index) {\n      var offset = tops.reduce(function (last, top, i) {\n        return top < tops[last] ? i : last;\n      }, 0);\n      var width = strategy.width[offset % strategy.count];\n      var rect = rects[index];\n      rect.top = tops[offset];\n      rect.left = strategy.left + (offset ? sum(strategy.width.slice(0, offset)) : 0);\n      rect.width = width;\n      rect.height = meta.height * (options.fixedHeight ? 1 : width / meta.width);\n      tops[offset] = tops[offset] + rect.height;\n    });\n    vm.style.height = Math.max.apply(Math, tops) + 'px';\n  }\n\n  function getRowStrategy(width, options) {\n    var count = width / options.lineGap;\n    var slotWidth = void 0;\n    if (options.singleMaxWidth >= width) {\n      count = 1;\n      slotWidth = Math.max(width, options.minLineGap);\n    } else {\n      var maxContentWidth = options.maxLineGap * ~~count;\n      var minGreedyContentWidth = options.minLineGap * ~~(count + 1);\n      var canFit = maxContentWidth >= width;\n      var canFitGreedy = minGreedyContentWidth <= width;\n      if (canFit && canFitGreedy) {\n        count = Math.round(count);\n        slotWidth = width / count;\n      } else if (canFit) {\n        count = ~~count;\n        slotWidth = width / count;\n      } else if (canFitGreedy) {\n        count = ~~(count + 1);\n        slotWidth = width / count;\n      } else {\n        count = ~~count;\n        slotWidth = options.maxLineGap;\n      }\n      if (count === 1) {\n        slotWidth = Math.min(width, options.singleMaxWidth);\n        slotWidth = Math.max(slotWidth, options.minLineGap);\n      }\n    }\n    return {\n      width: getArrayFillWith(slotWidth, count),\n      count: count,\n      left: getLeft(width, slotWidth * count, options.align)\n    };\n  }\n\n  function getRowStrategyWithGrow(width, grow) {\n    var total = sum(grow);\n    return {\n      width: grow.map(function (val) {\n        return width * val / total;\n      }),\n      count: grow.length,\n      left: 0\n    };\n  }\n\n  return {\n    calculate: calculate\n  };\n}();\n\nvar horizontalLineProcessor = function () {\n\n  function calculate(vm, options, metas, rects) {\n    var width = vm.$el.clientWidth;\n    var total = metas.length;\n    var top = 0;\n    var offset = 0;\n    while (offset < total) {\n      var strategy = getRowStrategy(width, options, metas, offset);\n      for (var i = 0, left = 0, meta, rect; i < strategy.count; i++) {\n        meta = metas[offset + i];\n        rect = rects[offset + i];\n        rect.top = top;\n        rect.left = strategy.left + left;\n        rect.width = meta.width * strategy.height / meta.height;\n        rect.height = strategy.height;\n        left += rect.width;\n      }\n      offset += strategy.count;\n      top += strategy.height;\n    }\n    vm.style.height = top + 'px';\n  }\n\n  function getRowStrategy(width, options, metas, offset) {\n    var greedyCount = getGreedyCount(width, options.lineGap, metas, offset);\n    var lazyCount = Math.max(greedyCount - 1, 1);\n    var greedySize = getContentSize(width, options, metas, offset, greedyCount);\n    var lazySize = getContentSize(width, options, metas, offset, lazyCount);\n    var finalSize = chooseFinalSize(lazySize, greedySize, width);\n    var height = finalSize.height;\n    var fitContentWidth = finalSize.width;\n    if (finalSize.count === 1) {\n      fitContentWidth = Math.min(options.singleMaxWidth, width);\n      height = metas[offset].height * fitContentWidth / metas[offset].width;\n    }\n    return {\n      left: getLeft(width, fitContentWidth, options.align),\n      count: finalSize.count,\n      height: height\n    };\n  }\n\n  function getGreedyCount(rowWidth, rowHeight, metas, offset) {\n    var count = 0;\n    for (var i = offset, width = 0; i < metas.length && width <= rowWidth; i++) {\n      width += metas[i].width * rowHeight / metas[i].height;\n      count++;\n    }\n    return count;\n  }\n\n  function getContentSize(rowWidth, options, metas, offset, count) {\n    var originWidth = 0;\n    for (var i = count - 1; i >= 0; i--) {\n      var meta = metas[offset + i];\n      originWidth += meta.width * options.lineGap / meta.height;\n    }\n    var fitHeight = options.lineGap * rowWidth / originWidth;\n    var canFit = fitHeight <= options.maxLineGap && fitHeight >= options.minLineGap;\n    if (canFit) {\n      return {\n        cost: Math.abs(options.lineGap - fitHeight),\n        count: count,\n        width: rowWidth,\n        height: fitHeight\n      };\n    } else {\n      var height = originWidth > rowWidth ? options.minLineGap : options.maxLineGap;\n      return {\n        cost: Infinity,\n        count: count,\n        width: originWidth * height / options.lineGap,\n        height: height\n      };\n    }\n  }\n\n  function chooseFinalSize(lazySize, greedySize, rowWidth) {\n    if (lazySize.cost === Infinity && greedySize.cost === Infinity) {\n      return greedySize.width < rowWidth ? greedySize : lazySize;\n    } else {\n      return greedySize.cost >= lazySize.cost ? lazySize : greedySize;\n    }\n  }\n\n  return {\n    calculate: calculate\n  };\n}();\n\nfunction getLeft(width, contentWidth, align) {\n  switch (align) {\n    case 'right':\n      return width - contentWidth;\n    case 'center':\n      return (width - contentWidth) / 2;\n    default:\n      return 0;\n  }\n}\n\nfunction sum(arr) {\n  return arr.reduce(function (sum, val) {\n    return sum + val;\n  });\n}\n\nfunction render(rects, metas) {\n  var metasNeedToMoveByTransform = metas.filter(function (meta) {\n    return meta.moveClass;\n  });\n  var firstRects = getRects(metasNeedToMoveByTransform);\n  applyRects(rects, metas);\n  var lastRects = getRects(metasNeedToMoveByTransform);\n  metasNeedToMoveByTransform.forEach(function (meta, i) {\n    meta.node[MOVE_CLASS_PROP] = meta.moveClass;\n    setTransform(meta.node, firstRects[i], lastRects[i]);\n  });\n  document.body.clientWidth; // forced reflow\n  metasNeedToMoveByTransform.forEach(function (meta) {\n    addClass(meta.node, meta.moveClass);\n    clearTransform(meta.node);\n  });\n}\n\nfunction getRects(metas) {\n  return metas.map(function (meta) {\n    return meta.vm.rect;\n  });\n}\n\nfunction applyRects(rects, metas) {\n  rects.forEach(function (rect, i) {\n    var style = metas[i].node.style;\n    metas[i].vm.rect = rect;\n    for (var prop in rect) {\n      style[prop] = rect[prop] + 'px';\n    }\n  });\n}\n\nfunction setTransform(node, firstRect, lastRect) {\n  var dx = firstRect.left - lastRect.left;\n  var dy = firstRect.top - lastRect.top;\n  var sw = firstRect.width / lastRect.width;\n  var sh = firstRect.height / lastRect.height;\n  node.style.transform = node.style.WebkitTransform = 'translate(' + dx + 'px,' + dy + 'px) scale(' + sw + ',' + sh + ')';\n  node.style.transitionDuration = '0s';\n}\n\nfunction clearTransform(node) {\n  node.style.transform = node.style.WebkitTransform = '';\n  node.style.transitionDuration = '';\n}\n\nfunction getTransitionEndEvent() {\n  var isWebkitTrans = window.ontransitionend === undefined && window.onwebkittransitionend !== undefined;\n  var transitionEndEvent = isWebkitTrans ? 'webkitTransitionEnd' : 'transitionend';\n  return transitionEndEvent;\n}\n\n/**\r\n * util\r\n */\n\nfunction getArrayFillWith(item, count) {\n  var getter = typeof item === 'function' ? function () {\n    return item();\n  } : function () {\n    return item;\n  };\n  var arr = [];\n  for (var i = 0; i < count; i++) {\n    arr[i] = getter();\n  }\n  return arr;\n}\n\nfunction addClass(elem, name) {\n  if (!hasClass(elem, name)) {\n    var cur = attr(elem, 'class').trim();\n    var res = (cur + ' ' + name).trim();\n    attr(elem, 'class', res);\n  }\n}\n\nfunction removeClass(elem, name) {\n  var reg = new RegExp('\\\\s*\\\\b' + name + '\\\\b\\\\s*', 'g');\n  var res = attr(elem, 'class').replace(reg, ' ').trim();\n  attr(elem, 'class', res);\n}\n\nfunction hasClass(elem, name) {\n  return new RegExp('\\\\b' + name + '\\\\b').test(attr(elem, 'class'));\n}\n\nfunction attr(elem, name, value) {\n  if (typeof value !== 'undefined') {\n    elem.setAttribute(name, value);\n  } else {\n    return elem.getAttribute(name) || '';\n  }\n}\n\nfunction on(elem, type, listener) {\n  var useCapture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  elem.addEventListener(type, listener, useCapture);\n}\n\nfunction off(elem, type, listener) {\n  var useCapture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n  elem.removeEventListener(type, listener, useCapture);\n}\n\n/***/ }),\n/* 32 */\n/*!*******************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-09ced947\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vue-waterfall/lib/waterfall.vue ***!\n  \\*******************************************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"vue-waterfall\",style:(_vm.style)},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 33 */\n/*!***********************************************************!*\\\n  !*** ./node_modules/vue-waterfall/lib/waterfall-slot.vue ***!\n  \\***********************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_vue_loader_lib_selector_type_script_index_0_waterfall_slot_vue__ = __webpack_require__(/*! !babel-loader!../../vue-loader/lib/selector?type=script&index=0!./waterfall-slot.vue */ 35);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__vue_loader_lib_template_compiler_index_id_data_v_1b429f74_hasScoped_false_buble_transforms_vue_loader_lib_selector_type_template_index_0_waterfall_slot_vue__ = __webpack_require__(/*! !../../vue-loader/lib/template-compiler/index?{\"id\":\"data-v-1b429f74\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../../vue-loader/lib/selector?type=template&index=0!./waterfall-slot.vue */ 36);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-1b429f74\",\"scoped\":false,\"hasInlineConfig\":false}!../../vue-loader/lib/selector?type=styles&index=0!./waterfall-slot.vue */ 34)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_vue_loader_lib_selector_type_script_index_0_waterfall_slot_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__vue_loader_lib_template_compiler_index_id_data_v_1b429f74_hasScoped_false_buble_transforms_vue_loader_lib_selector_type_template_index_0_waterfall_slot_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 34 */\n/*!**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-1b429f74\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./node_modules/vue-waterfall/lib/waterfall-slot.vue ***!\n  \\**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 35 */\n/*!*********************************************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./node_modules/vue-waterfall/lib/waterfall-slot.vue ***!\n  \\*********************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  data: function data() {\n    return {\n      isShow: false\n    };\n  },\n  props: {\n    width: {\n      required: true,\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    height: {\n      required: true,\n      validator: function validator(val) {\n        return val >= 0;\n      }\n    },\n    order: {\n      default: 0\n    },\n    moveClass: {\n      default: ''\n    }\n  },\n  methods: {\n    notify: function notify() {\n      this.$parent.$emit('reflow', this);\n    },\n    getMeta: function getMeta() {\n      return {\n        vm: this,\n        node: this.$el,\n        order: this.order,\n        width: this.width,\n        height: this.height,\n        moveClass: this.moveClass\n      };\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    this.rect = {\n      top: 0,\n      left: 0,\n      width: 0,\n      height: 0\n    };\n    this.$watch(function () {\n      return _this.width, _this.height;\n    }, this.notify);\n  },\n  mounted: function mounted() {\n    var _this2 = this;\n\n    this.$parent.$once('reflowed', function () {\n      _this2.isShow = true;\n    });\n    this.notify();\n  },\n  destroyed: function destroyed() {\n    this.notify();\n  }\n});\n\n/***/ }),\n/* 36 */\n/*!************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1b429f74\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vue-waterfall/lib/waterfall-slot.vue ***!\n  \\************************************************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShow),expression:\"isShow\"}],staticClass:\"vue-waterfall-slot\"},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 37 */\n/*!**********************************************!*\\\n  !*** ./client/components/waterfallImage.vue ***!\n  \\**********************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_waterfallImage_vue__ = __webpack_require__(/*! !babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./waterfallImage.vue */ 39);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_e1d6dc74_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_waterfallImage_vue__ = __webpack_require__(/*! !../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-e1d6dc74\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./waterfallImage.vue */ 40);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-e1d6dc74\",\"scoped\":true,\"hasInlineConfig\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./waterfallImage.vue */ 38)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../node_modules/vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-e1d6dc74\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_waterfallImage_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_e1d6dc74_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_waterfallImage_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 38 */\n/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-e1d6dc74\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?sourceMap!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./client/components/waterfallImage.vue ***!\n  \\***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 39 */\n/*!********************************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./client/components/waterfallImage.vue ***!\n  \\********************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'waterfallImage',\n  props: {\n    id: Number,\n    tags: String,\n    author: String,\n    created_at: Number,\n    source: String,\n    score: Number,\n    file_size: Number,\n    file_url: String,\n    width: Number,\n    height: Number,\n    preview_url: String,\n    actual_preview_width: Number,\n    actual_preview_height: Number,\n    sample_url: String,\n    sample_width: Number,\n    sample_height: Number,\n    sample_file_size: Number,\n    jpeg_url: String,\n    jpeg_file_size: Number,\n    rating: String,\n    isPageInd: { type: Boolean, default: false },\n    page: Number\n\n    /*\r\n    \"rating\": \"s\",\r\n    \"has_children\": false,\r\n    \"parent_id\": null,\r\n    \"status\": \"active\",\r\n    \"width\": 2976,\r\n    \"height\": 1881,\r\n    \"is_held\": false,\r\n    \"frames_pending_string\": \"\",\r\n    \"frames_pending\": [],\r\n    \"frames_string\": \"\",\r\n    \"frames\": [] */\n  },\n  methods: {\n    onHover: function onHover() {\n      if (this.loaded) this.hover = true;\n    },\n    onHoverOff: function onHoverOff() {\n      this.hover = false;\n    },\n    recalculateHeight: function recalculateHeight(event) {\n      var height = void 0;\n      height = this.$refs.wrapper.offsetHeight;\n      if (height != 0) {\n        console.log('#' + this.id + ' loaded!');\n        this.loaded = true;\n        this.$emit('height-change', height);\n      }\n    }\n  },\n  data: function data() {\n    return {\n      loaded: false,\n      hover: false,\n      placeholderStyle: {}\n    };\n  },\n\n  computed: {\n    // placeholderStyle() {\n    //   return\n    // },\n    tagsArr: function tagsArr() {\n      return this.tags.split(' ');\n    }\n  },\n  created: function created() {\n    if (this.isPageInd) {\n      // TODO: Replace router.currentRoute.query.page with current page\n      //   document.addEventListener('scroll', () => {\n      //           let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n      //   if (scrollTop + window.innerHeight >= this.$root.top && router.currentRoute.query.page) {\n      //     router.currentRoute.query.page=this.page\n      //   }\n      //   });\n    }\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    this.$nextTick(function () {\n      var height = Math.ceil(parseInt(window.getComputedStyle(_this.$refs.wrapper, null)['width']) * (_this.sample_height / _this.sample_width));\n      console.log(height, window.getComputedStyle(_this.$refs.wrapper, null)['width']);\n      var style = {\n        height: height + 'px',\n        marginBottom: -height + 'px'\n      };\n      _this.placeholderStyle = style;\n      console.log('#' + _this.id + ' placeholder drawn!');\n    });\n  }\n});\n\n/***/ }),\n/* 40 */\n/*!**********************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-e1d6dc74\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/components/waterfallImage.vue ***!\n  \\**********************************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"appear\":\"\",\"name\":\"slide-fade\"}},[_c('div',{ref:\"wrapper\",staticClass:\"wf-wrapper\",on:{\"mouseover\":_vm.onHover,\"mouseout\":_vm.onHoverOff}},[(_vm.isPageInd)?_c('div',[_c('div',{staticClass:\"wf-pageindicator\"},[_vm._v(\"\\r\\n        Page \"+_vm._s(_vm.page)+\"\\r\\n      \")])]):_c('div',[_c('div',{staticClass:\"wfimg-container\"},[_c('router-link',{attrs:{\"to\":'/'+_vm.id}},[_c('transition',{attrs:{\"name\":\"placeholder-fade-away\"}},[(~_vm.loaded)?_c('div',{staticClass:\"placeholder\",style:(_vm.placeholderStyle)}):_vm._e()]),_vm._v(\" \"),_c('img',{staticClass:\"wfimg\",attrs:{\"src\":_vm.preview_url,\"alt\":_vm.id},on:{\"loadend\":_vm.recalculateHeight}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"wfdesc\"},[_c('div',{staticClass:\"wfdesc-row\"},[_c('div',{staticClass:\"wfdesc-resolution\",on:{\"click\":function($event){_vm.loaded=false}}},[_vm._v(_vm._s(_vm.width)+\" x \"+_vm._s(_vm.height))])]),_vm._v(\" \"),_c('div',{staticClass:\"wfdesc-row\"},[_c('span',{staticClass:\"wfdesc-author\"},[_vm._v(\"uploaded by \"+_vm._s(_vm.author))])])]),_vm._v(\" \"),_c('transition',{attrs:{\"name\":\"slide-fade\"}},[(_vm.hover)?_c('div',{staticClass:\"wfextra\"},[_c('div',{staticClass:\"wfextra-tags\"},_vm._l((_vm.tagsArr),function(tag){return _c('div',{staticClass:\"tag\"},[_c('span',{staticClass:\"tag-hash\"},[_vm._v(\"#\")]),_vm._v(_vm._s(tag))])}))]):_vm._e()])],1)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 41 */\n/*!********************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-f93712e6\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/views/post.vue ***!\n  \\********************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[(!_vm.tags.length)?_c('div',{staticClass:\"title\"},[_c('img',{staticClass:\"favico\",attrs:{\"src\":\"/icon/icon.png\",\"alt\":\"\"}}),_vm._v(\" \"),_c('p',[_vm._v(\"konamirr\")])]):_vm._e(),_vm._v(\" \"),_c('headerbar',{staticClass:\"header\",attrs:{\"query\":_vm.startTags,\"ratingFlag\":_vm.rating},on:{\"querySubmission\":_vm.querySubmission}}),_vm._v(\" \"),_c('div',{staticClass:\"page\"},[(_vm.notError)?_c('waterfall',{ref:\"waterfall\",staticClass:\"waterfall\",attrs:{\"line-gap\":256,\"watch\":_vm.imgsArr,\"align\":\"center\"}},_vm._l((_vm.imgsArr),function(item,index){return _c('waterfall-slot',{key:index,staticClass:\"wfslot\",attrs:{\"width\":240,\"height\":item.realHeight||_vm.calcHeight(item),\"order\":index,\"move-class\":\"move\"}},[_c('waterfall-image',_vm._b({attrs:{\"move-class\":\"move\"},on:{\"height-change\":function($event){_vm.updateHeight(arguments, item, index)}}},'waterfall-image',item,false))],1)})):_c('div',{staticClass:\"errorMsg\"})],1),_vm._v(\" \"),_c('div',{staticClass:\"loader-wrapper\"},[(_vm.isBusy)?_c('div',{staticClass:\"loading\"},[_vm._v(\"\\r\\n      loading next page...\\r\\n    \")]):(!_vm.reachingEnd)?_c('div',{staticClass:\"loadnext\"},[_c('button',{on:{\"click\":_vm.loadNextPage}},[_vm._v(\"load the next page\")])]):_c('div',{staticClass:\"reaching-end\"},[_vm._v(\"\\r\\n      Nothing more to show.\\r\\n    \")])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 42 */\n/*!********************************!*\\\n  !*** ./client/views/image.vue ***!\n  \\********************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_image_vue__ = __webpack_require__(/*! !babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./image.vue */ 44);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_401025be_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_image_vue__ = __webpack_require__(/*! !../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-401025be\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./image.vue */ 45);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-401025be\",\"scoped\":true,\"hasInlineConfig\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./image.vue */ 43)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../node_modules/vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-401025be\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_image_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_401025be_hasScoped_true_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_image_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 43 */\n/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-401025be\",\"scoped\":true,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?sourceMap!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./client/views/image.vue ***!\n  \\*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 44 */\n/*!******************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./client/views/image.vue ***!\n  \\******************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash__ = __webpack_require__(/*! lodash */ 5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_lodash___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_lodash__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__config_js__ = __webpack_require__(/*! ../config.js */ 6);\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'image',\n  props: {\n    id: Number\n  },\n  created: function created() {\n    // fetch image and comment\n    this.updateData();\n  },\n  data: function data() {\n    return {\n      imageInfo: new Object(),\n      comments: new Array()\n    };\n  },\n\n  watch: {\n    $route: function $route(to, from) {\n      if (!/\\/\\d+/.test(from)) this.updateData();\n    }\n  },\n  computed: {\n    tagsArr: function tagsArr() {\n      return this.imageInfo.tags ? this.imageInfo.tags.split(' ') : [];\n    },\n    hasJpegVariant: function hasJpegVariant() {\n      return !/(\\.jpg|\\.jpeg)/i.test(this.imageInfo.file_url);\n    }\n  },\n  methods: {\n    fetchImageData: function fetchImageData() {\n      var _this = this;\n\n      var request = new XMLHttpRequest();\n      request.onreadystatechange = function () {\n        if (request.readyState === XMLHttpRequest.DONE) {\n          if (request.status === 200) {\n            var responseObject = JSON.parse(request.responseText);\n            console.log(responseObject);\n            if (!!responseObject[0]) _this.imageInfo = __WEBPACK_IMPORTED_MODULE_0_lodash___default.a.assign({}, _this.imageInfo, responseObject[0]);\n            // else this.$router.replace('/e/404');\n            // console.log(this.imageInfo);\n            // this.infoLoaded();58537537\n          } else if (request.status >= 400) {\n            // Error! show error information\n            console.log('Error: HTTP ' + request.status);\n            // this.$router.replace('/e/404');\n          }\n        }\n      };\n      // let requestURI = `https://konachan.kcsl.ink/kona-api/post.json?tags=id:${this.id}`;\n      var requestURI = __WEBPACK_IMPORTED_MODULE_1__config_js__[\"a\" /* default */].methods.getImageURI({ id: this.id });\n      request.open('GET', requestURI);\n      request.send();\n      console.log('Request sent!', requestURI);\n    },\n    fetchCommentData: function fetchCommentData() {\n      var _this2 = this;\n\n      var request = new XMLHttpRequest();\n      request.onreadystatechange = function () {\n        if (request.readyState === XMLHttpRequest.DONE) {\n          if (request.status === 200) {\n            var responseObject = JSON.parse(request.responseText);\n            _this2.comments = responseObject;\n            // this.infoLoaded();\n          } else if (request.status >= 400) {\n            // Error! show error information\n            console.log('Error: HTTP ' + request.status);\n            // this.$router.replace('/e/404');\n          }\n        }\n      };\n      // let requestURI = `https://konachan.kcsl.ink/kona-api/comment.json?post_id=${this.id}`;\n      var requestURI = __WEBPACK_IMPORTED_MODULE_1__config_js__[\"a\" /* default */].methods.getCommentURI({ id: this.id });\n      request.open('GET', requestURI);\n      request.send();\n      console.log('Request sent!', requestURI);\n    },\n    updateData: function updateData() {\n      this.fetchImageData();\n      this.fetchCommentData();\n    },\n    regulateComment: function regulateComment(comment) {}\n  }\n});\n\n/***/ }),\n/* 45 */\n/*!********************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-401025be\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/views/image.vue ***!\n  \\********************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"img-desc-wrapper\"},[_c('div',{staticClass:\"image-wrapper\"},[_c('img',{staticClass:\"image\",attrs:{\"src\":_vm.imageInfo.jpeg_url,\"alt\":_vm.imageInfo.tags?_vm.imageInfo.tags:''}})]),_vm._v(\" \"),_c('div',{staticClass:\"desc\"},[_c('div',{staticClass:\"title-id\"},[_vm._v(\"\\n        # \"+_vm._s(_vm.id)+\"\\n      \")]),_vm._v(\" \"),_c('div',{staticClass:\"tags\"},_vm._l((_vm.tagsArr),function(tag,index){return _c('div',{key:index,staticClass:\"tag\"},[_c('span',{staticClass:\"tag-hash\"},[_vm._v(\"# \")]),_vm._v(_vm._s(tag.replace('_', ' ')))])})),_vm._v(\" \"),_c('div',{staticClass:\"download\"},[_c('p',[_vm._v(\"\\n          * Please use right-click download for the following links\\n        \")]),_vm._v(\" \"),_c('a',{staticClass:\"download-link\",attrs:{\"href\":_vm.imageInfo.file_url,\"download\":\"\"}},[_vm._v(\"Download Original picture (\"+_vm._s((_vm.imageInfo.file_size/1048576).toFixed(2))+\"MiB)\")]),_vm._v(\" \"),(_vm.hasJpegVariant)?_c('a',{staticClass:\"download-link\",attrs:{\"href\":_vm.imageInfo.jpeg_url,\"download\":\"\"}},[_vm._v(\"Download JPEG Variant (\"+_vm._s((_vm.imageInfo.jpeg_file_size/1048576).toFixed(2))+\"MiB)\")]):_vm._e()])])]),_vm._v(\" \"),_c('div',{staticClass:\"comments\"},_vm._l((_vm.comments),function(comment,index){return _c('div',{key:index,staticClass:\"comment\"},[_vm._v(\"\\n      \"+_vm._s(comment.creator)+\":\"),_c('br'),_vm._v(\" \"+_vm._s(comment.body)+\"\\n    \")])}))])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 46 */\n/*!********************************!*\\\n  !*** ./client/views/error.vue ***!\n  \\********************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_error_vue__ = __webpack_require__(/*! !babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./error.vue */ 48);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_efe7a02a_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_error_vue__ = __webpack_require__(/*! !../../node_modules/vue-loader/lib/template-compiler/index?{\"id\":\"data-v-efe7a02a\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./error.vue */ 49);\nfunction injectStyle (ssrContext) {\n  __webpack_require__(/*! !../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\"vue\":true,\"id\":\"data-v-efe7a02a\",\"scoped\":false,\"hasInlineConfig\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./error.vue */ 47)\n}\nvar normalizeComponent = __webpack_require__(/*! ../../node_modules/vue-loader/lib/component-normalizer */ 0)\n/* script */\n\n/* template */\n\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_error_vue__[\"a\" /* default */],\n  __WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_efe7a02a_hasScoped_false_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_error_vue__[\"a\" /* default */],\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (Component.exports);\n\n\n/***/ }),\n/* 47 */\n/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?sourceMap&-autoprefixer!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-efe7a02a\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./client/views/error.vue ***!\n  \\*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/\n/*! dynamic exports provided */\n/*! all exports used */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 48 */\n/*!******************************************************************************************************************************!*\\\n  !*** ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./client/views/error.vue ***!\n  \\******************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n//\n//\n//\n//\n//\n//\n//\n\n/* harmony default export */ __webpack_exports__[\"a\"] = ({\n  name: 'errorPage',\n  props: ['number']\n});\n\n/***/ }),\n/* 49 */\n/*!*********************************************************************************************************************************************************************************************************************!*\\\n  !*** ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-efe7a02a\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/views/error.vue ***!\n  \\*********************************************************************************************************************************************************************************************************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_vm._v(\"\\r\\n  \\r\\n  ERROR: \"+_vm._s(_vm.number)+\"\\r\\n\")])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ __webpack_exports__[\"a\"] = (esExports);\n\n/***/ }),\n/* 50 */\n/*!*******************************!*\\\n  !*** ./client/store/index.js ***!\n  \\*******************************/\n/*! exports provided: default */\n/*! exports used: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(/*! vue */ 2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_vuex__ = __webpack_require__(/*! vuex */ 51);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__config_js__ = __webpack_require__(/*! ../config.js */ 6);\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n\n\n\n\n__WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].use(__WEBPACK_IMPORTED_MODULE_1_vuex__[\"a\" /* default */]);\n\nvar state = {\n  imgsArr: [],\n  tags: [],\n  page: 1,\n  errorState: false,\n  errorMsg: \"\",\n  reachingEnd: false,\n  busyState: false,\n  scrollPosition: 0\n};\n\nvar mutations = {\n  resetImageArr: function resetImageArr(state) {\n    state.imgsArr = [];\n  },\n  appendImageArr: function appendImageArr(state, newArr) {\n    state.imgsArr.push.apply(state.imgsArr, newArr);\n  },\n  setPage: function setPage(state, page) {\n    state.page = page;\n  },\n  nextPage: function nextPage(state) {\n    state.page++;\n  },\n  resetPage: function resetPage(state) {\n    state.page = 1;\n  },\n  setTags: function setTags(state, tagsArr) {\n    state.tags = tagsArr;\n  },\n  commitRealHeight: function commitRealHeight(state, _ref) {\n    var index = _ref.index,\n        height = _ref.height;\n\n    __WEBPACK_IMPORTED_MODULE_0_vue__[\"a\" /* default */].set(state.imgsArr[index], 'realHeight', height);\n  },\n  resetStates: function resetStates(state) {\n    state.errorState = false;\n    state.reachingEnd = false;\n  },\n  recvError: function recvError(state, errorMsg) {\n    state.errorState = true;\n    state.errorMsg = errorMsg;\n    state.reachingEnd = true;\n  },\n  reachEnd: function reachEnd(state) {\n    state.reachingEnd = true;\n  },\n  setBusy: function setBusy(state, busy) {\n    state.busyState = busy;\n  },\n  setScroll: function setScroll(state, scroll) {\n    state.scrollPosition = scroll;\n  }\n};\n\nvar actions = {\n  getPosts: function getPosts(context, _ref2) {\n    var _ref2$nextPage = _ref2.nextPage,\n        nextPage = _ref2$nextPage === undefined ? false : _ref2$nextPage,\n        _ref2$refresh = _ref2.refresh,\n        refresh = _ref2$refresh === undefined ? false : _ref2$refresh,\n        _ref2$rating = _ref2.rating,\n        rating = _ref2$rating === undefined ? 's' : _ref2$rating,\n        _ref2$callback = _ref2.callback,\n        callback = _ref2$callback === undefined ? null : _ref2$callback,\n        _ref2$callbackArgs = _ref2.callbackArgs,\n        callbackArgs = _ref2$callbackArgs === undefined ? null : _ref2$callbackArgs;\n\n    if (context.state.isBusy == true) return;\n    if (nextPage) context.commit('nextPage');\n    context.commit('setBusy', true);\n    var page = state.page;\n    var request = new XMLHttpRequest();\n    request.onreadystatechange = function () {\n      if (request.readyState === XMLHttpRequest.DONE) {\n        if (request.status === 200) {\n          var responseObject = JSON.parse(request.responseText);\n          if (responseObject.length == 0 || responseObject.success == false) {\n            // Empty response! Either nothing have been found,\n            // or already reaching the end.\n            // this.reachingEnd = true;\n            context.commit('reachEnd');\n            // window.removeEventListener('scroll', this.checkScrollingAndCallUpdate);\n            console.log('Nothing more to show.');\n          } else {\n            if (rating == 's') _.remove(responseObject, function (v) {\n              return v.rating != 's';\n            });\n            // Success! append retrieved data after current data array\n            // this.imgsArr.push({\n            //   isPageInd: true,\n            //   page: this.page\n            // });\n            // this.imgsArr.push.apply(this.imgsArr, responseObject);\n            // console.log(this.imgsArr);\n            responseObject.unshift({\n              isPageInd: true,\n              page: page\n            });\n            context.commit('appendImageArr', responseObject);\n            if (callback) callback.apply(undefined, _toConsumableArray(callbackArgs));\n          }\n          // this.notError = true;\n        } else if (request.status >= 400) {\n          // Error! show error information,n\n          console.log('Error: HTTP ' + request.status);\n          // console.log(request.responseText);\n          // this.notError = false;\n          var errorMsg = JSON.parse(request.responseText).reason;\n          context.commit('recvError', errorMsg);\n        }\n      }\n      context.commit('setBusy', false);\n    };\n    // let requestURI = `https://konachan.kcsl.ink/kona-api/post.json?tags=${context.getters.queryTags}&page=${context.state.page}`;\n    var requestURI = __WEBPACK_IMPORTED_MODULE_2__config_js__[\"a\" /* default */].methods.getPostListURI({ tags: context.getters.queryTags, page: context.state.page });\n    request.open('GET', requestURI);\n    request.send();\n    console.log('Request sent!', requestURI);\n  }\n};\n\nvar getters = {\n  queryTags: function queryTags(state) {\n    return state.tags ? state.tags.join('+') : '';\n  }\n};\n\nvar store = new __WEBPACK_IMPORTED_MODULE_1_vuex__[\"a\" /* default */].Store({\n  state: state,\n  mutations: mutations,\n  getters: getters,\n  actions: actions\n});\n\n/* harmony default export */ __webpack_exports__[\"a\"] = (store);\n\n/***/ }),\n/* 51 */,\n/* 52 */\n/*!***********************!*\\\n  !*** ./client/pwa.js ***!\n  \\***********************/\n/*! no exports provided */\n/*! all exports used */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime__ = __webpack_require__(/*! offline-plugin/runtime */ 53);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime__);\n\n\n__WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime___default.a.install({\n  // When an update is ready, tell ServiceWorker to take control immediately:\n  onUpdateReady: function onUpdateReady() {\n    console.log('update ready');\n    __WEBPACK_IMPORTED_MODULE_0_offline_plugin_runtime___default.a.applyUpdate();\n  },\n\n\n  // Reload to get the new version:\n  onUpdated: function onUpdated() {\n    console.log('updated');\n    location.reload();\n  }\n});\n\n/***/ })\n],[7]);\n\n\n// WEBPACK FOOTER //\n// client.11c15c55.js","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c15fbea\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./header.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./header.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c15fbea\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./header.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4c15fbea\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/components/header.vue\n// module id = 4\n// module chunks = 0","const requestURI = {\r\n  postList: \"https://konachan.kcsl.ink/kona-api/post.json?tags=__TAGS__&page=__PAGE__\",\r\n  image: \"https://konachan.kcsl.ink/kona-api/post.json?tags=id:__ID__\",\r\n  comment: \"https://konachan.kcsl.ink/kona-api/comment.json?post_id=__ID__\"\r\n}\r\n\r\nconst methods = {\r\n  getPostListURI({ tags, page }) {\r\n    return requestURI.postList.replace(\"__TAGS__\", tags).replace(\"__PAGE__\", page)\r\n  },\r\n  getImageURI({ id }) {\r\n    return requestURI.image.replace(\"__ID__\", id)\r\n  },\r\n  getCommentURI({ id }) {\r\n    return requestURI.comment.replace(\"__ID__\", id)\r\n  }\r\n}\r\n\r\nexport default {\r\n  requestURI,\r\n  methods\r\n}\n\n\n// WEBPACK FOOTER //\n// ./client/config.js","import './promise-polyfill'\nimport { app } from './app'\n\n// Enable progressive web app support (with offline-plugin)\nif (process.env.NODE_ENV === 'production') {\n  require('./pwa')\n}\n\napp.$mount('#app')\n\n\n\n// WEBPACK FOOTER //\n// ./client/index.js","import Promise from 'promise-polyfill'\n\nwindow.Promise = window.Promise || Promise\n\n\n\n// WEBPACK FOOTER //\n// ./client/promise-polyfill.js","import Vue from 'vue'\nimport { sync } from 'vuex-router-sync'\nimport App from './components/App'\nimport router from './router'\nimport store from './store'\n\nsync(store, router)\n\nconst app = new Vue({\n  router,\n  store,\n  ...App\n})\n\nexport { app, router, store }\n\n\n\n// WEBPACK FOOTER //\n// ./client/app.js","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ab4e3618\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ab4e3618\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/components/App.vue\n// module id = 14\n// module chunks = 0","<template>\n  <div id=\"app\">\n    <router-view class=\"router-view\" keep-alive></router-view>\n    <!-- <router-view class=\"image-overlay\" name=\"imageOverlay\"></router-view> -->\n  </div>\n</template>\n\n<script>\nimport headerbar from './header';\nexport default {\n  components: {\n    headerbar\n  }\n};\n</script>\n\n<style lang=\"scss\">\n@import '../styles/_imports.scss';\n\nbody {\n  margin: 0px;\n  padding: 0px;\n  background: map-get($greys, 50);\n  font-family: $text-font;\n}\n\n.header {\n  width: 100%;\n  position: sticky;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// client/components/App.vue","<template>\r\n  <div class=\"header\">\r\n    <div class=\"url\">\r\n      <!-- <span class=\"url-slash\">\r\n        / {{isSafeMode?\"safe \":\"unsafe \"}}\r\n      </span> -->\r\n      <input id=\"url-text\" class=\"url-text\" type=\"text\"\r\n      v-model=\"queryStr\"\r\n      :class=\"{ err: isErr }\"\r\n      placeholder=\"your_tags\"\r\n      @keypress.enter=\"submitQuery($event)\"\r\n      @change=\"searchQueryChanged()\">\r\n    </div>\r\n    <div class=\"user\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _ from 'lodash';\r\n\r\nexport default {\r\n  name: 'headerbar',\r\n  props: {\r\n    query: {\r\n      type: Array,\r\n      default() {\r\n        return [];\r\n      }\r\n    },\r\n    rating: { type: String, default: 's' }\r\n  },\r\n  data() {\r\n    return {\r\n      iquery: this.query || [],\r\n      irating: this.rating || 's',\r\n      queryStr: _.remove(this.iquery, v => /\\brating:\\w\\b/i.test(v)).join(' '),\r\n      isErr: false\r\n    };\r\n  },\r\n  computed: {\r\n    // queryStr: {\r\n    //   get() {\r\n    //     return _.remove(this.iquery, v => /\\brating:\\w\\b/i.test(v)).join(' ');\r\n    //   },\r\n    //   set(val) {\r\n    //     this.iquery = val.split(' ').unshift('rating:' + this.rating);\r\n    //   }\r\n    // // },\r\n    // isErr() {\r\n    //   return this.iquery.length > 5;\r\n    // },\r\n    isSafeMode() {\r\n      return this.irating == 's';\r\n    }\r\n  },\r\n  watch: {\r\n    queryStr() {\r\n      this.iquery = _.without(this.queryStr.split(' '), '');\r\n      this.queryStr.replace(/\\b(unsafe|safe) /i, '');\r\n      console.log(this.iquery);\r\n\r\n      this.isErr = this.iquery.length > 5;\r\n      this.irating = /\\b(rating:[^sS]|unsafe) /i.test(this.queryStr)\r\n        ? 'e'\r\n        : /\\b(rating:[sS]|safe) /i.test(this.queryStr) ? 's' : this.irating;\r\n    }\r\n  },\r\n  methods: {\r\n    searchQueryChanged() {},\r\n    submitQuery(event) {\r\n      console.log('Enter key fired!');\r\n      console.log(event);\r\n      this.$emit('querySubmission', this.iquery, this.irating);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../styles/_imports.scss';\r\n\r\n.header {\r\n  display: flex;\r\n  flex-direction: row;\r\n  background: map-get($map: $greys, $key: 50);\r\n}\r\n\r\n.url {\r\n  text-align: center;\r\n  flex-grow: 1;\r\n  padding: 0.8em;\r\n  font-family: $display-font;\r\n  font-weight: bold;\r\n  @media screen and (min-width: 720px) {\r\n    font-size: 1.5em;\r\n  }\r\n  color: map-get($greys, 300);\r\n}\r\n.url-text {\r\n  background: transparent;\r\n  border: none;\r\n  font: inherit;\r\n  text-align: center;\r\n  // display: inline;\r\n  color: $accent-pink;\r\n  // width: 80%;\r\n  width: auto;\r\n  min-width: 120px;\r\n  &:focus {\r\n    color: map-get($greys, 500);\r\n  }\r\n  &.err {\r\n    color: $warn-alizarin;\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// client/components/header.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"url\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.queryStr),expression:\"queryStr\"}],staticClass:\"url-text\",class:{ err: _vm.isErr },attrs:{\"id\":\"url-text\",\"type\":\"text\",\"placeholder\":\"your_tags\"},domProps:{\"value\":(_vm.queryStr)},on:{\"keypress\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key)){ return null; }_vm.submitQuery($event)},\"change\":function($event){_vm.searchQueryChanged()},\"input\":function($event){if($event.target.composing){ return; }_vm.queryStr=$event.target.value}}})]),_vm._v(\" \"),_c('div',{staticClass:\"user\"})])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c15fbea\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/components/header.vue\n// module id = 21\n// module chunks = 0","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view',{staticClass:\"router-view\",attrs:{\"keep-alive\":\"\"}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ab4e3618\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/components/App.vue\n// module id = 22\n// module chunks = 0","import Vue from 'vue'\nimport Router from 'vue-router'\nimport post from '../views/post'\nimport image from '../views/image'\nimport errorPage from '../views/error'\n\nVue.use(Router)\n\nexport default new Router({\n  mode: 'hash',\n  routes: [\n    {\n      path: '/',\n      component: post,\n      props: route => ({\n        startPage: route.query.page ? parseInt(route.query.page) : 1,\n        startTags: route.query.tags ? decodeURIComponent(route.query.tags).split('+') : [],\n      })\n    },\n    {\n      path: '/:id',\n      component: image,\n      props: route => ({\n        id: parseInt(route.params.id)\n      })\n    },\n    {\n      path: '/e/:number',\n      component: errorPage,\n      props: route => ({ number: route.params.number })\n    },\n    // {\n    //   path: '*',\n    //   component: errorPage,\n    //   props: { number: 404 }\n    // }\n\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./client/router/index.js","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-f93712e6\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./post.vue\")\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-f93712e6\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=1!./post.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./post.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-f93712e6\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./post.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/views/post.vue\n// module id = 25\n// module chunks = 0","<template>\r\n<div class=\"wrapper\">\r\n  <div class=\"title\" v-if=\"!tags.length\">\r\n    <img class=\"favico\" src=\"/icon/icon.png\" alt=\"\">\r\n    <p>konamirr</p>\r\n  </div>\r\n  <headerbar class=\"header\" :query=\"startTags\" @querySubmission=\"querySubmission\" :ratingFlag=\"rating\"> </headerbar>\r\n  <div class=\"page\">    \r\n    <waterfall \r\n      class=\"waterfall\" :line-gap=\"256\" \r\n      :watch=\"imgsArr\" align=\"center\" v-if=\"notError\"\r\n      ref=\"waterfall\"\r\n      >\r\n      <!-- <transition-group name=\"slide-fade\"> -->\r\n        <waterfall-slot\r\n          class=\"wfslot\"\r\n          v-for=\"(item, index) in imgsArr\"\r\n          :width=\"240\" :height=\"item.realHeight||calcHeight(item)\"\r\n          :order=\"index\"\r\n          :key=\"index\"\r\n          move-class=\"move\"\r\n          >\r\n          <waterfall-image v-bind=\"item\"\r\n          @height-change=\"updateHeight(arguments, item, index)\"\r\n          move-class=\"move\"\r\n          ></waterfall-image>\r\n        </waterfall-slot>\r\n      <!-- </transition-group> -->\r\n    </waterfall>\r\n    <div class=\"errorMsg\" v-else>\r\n\r\n    </div>\r\n  </div>\r\n  <div class=\"loader-wrapper\">\r\n    <div class=\"loading\" v-if=\"isBusy\">\r\n      loading next page...\r\n    </div>\r\n    <div class=\"loadnext\" v-else-if=\"!reachingEnd\">\r\n      <button @click=\"loadNextPage\">load the next page</button>\r\n    </div>\r\n    <div class=\"reaching-end\" v-else>\r\n      Nothing more to show.\r\n    </div>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport headerbar from '../components/header';\r\nimport Waterfall from 'vue-waterfall/lib/waterfall';\r\nimport WaterfallSlot from 'vue-waterfall/lib/waterfall-slot';\r\nimport waterfallImage from '../components/waterfallImage';\r\n\r\nexport default {\r\n  name: 'post',\r\n  props: {\r\n    mirrorRoot: String,\r\n    startPage: { type: Number, default: 1 },\r\n    startTags: { type: Array, default: [] },\r\n    startRatingFlag: { type: String, default: 's' }\r\n  },\r\n  components: {\r\n    Waterfall,\r\n    WaterfallSlot,\r\n    headerbar,\r\n    waterfallImage\r\n  },\r\n  data() {\r\n    return {\r\n      // imgsArr: [],\r\n      // page: this.startPage || 1,\r\n      // tags: this.startTags || [],\r\n      rating: 's',\r\n      // isBusy: true,\r\n      // reachingEnd: false,\r\n      // notError: true,\r\n      // errorMsg: '',\r\n      // config. TODO: move them out into a separate config file\r\n      scrollMargin: 1 // in px\r\n    };\r\n  },\r\n  computed: {\r\n    isBusy() {\r\n      return this.$store.state.busyState;\r\n    },\r\n    reachingEnd() {\r\n      return this.$store.state.reachingEnd;\r\n    },\r\n    notError() {\r\n      return !this.$store.state.errorState;\r\n    },\r\n    errorMsg() {\r\n      return this.$store.state.errorMsg;\r\n    },\r\n    imgsArr() {\r\n      return this.$store.state.imgsArr;\r\n    },\r\n    page() {\r\n      return this.$store.state.page;\r\n    },\r\n    tags: {\r\n      get() {\r\n        return this.$store.state.tags;\r\n      },\r\n      set(v) {\r\n        this.$store.commit('setTags', v);\r\n      }\r\n    }\r\n  },\r\n  created() {},\r\n  mounted() {\r\n    if (!this.imgsArr.length) {\r\n      if (this.$route.query.tags) this.$store.commit('setTags', this.$route.query.tags.split('+'));\r\n      this.getPosts();\r\n      if (this.startPage) this.$store.commit('setPage', this.startPage);\r\n    }\r\n    window.addEventListener('scroll', this.checkScrollingAndCallUpdate);\r\n    this.$refs.waterfall.$emit('reflow');\r\n    this.$nextTick(() => {\r\n      if (this.$store.state.scrollPosition) document.documentElement.scrollTop = this.$store.scrollPosition;\r\n    });\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    this.$store.commit('setScroll', document.documentElement.scrollTop);\r\n    window.removeEventListener('scroll', this.checkScrollingAndCallUpdate);\r\n    this.reachingEnd = false;\r\n    next();\r\n  },\r\n  watch: {\r\n    //   $route(t, f) {\r\n    //     this.reachingEnd = false;\r\n    //     console.log(`Redirecting from ${f} to ${t}`);\r\n    //     window.removeEventListener('scroll', this.checkScrollingAndCallUpdate);\r\n    //   }\r\n  },\r\n  methods: {\r\n    querySubmission(tags, rating) {\r\n      this.rating = rating;\r\n      this.tags = tags;\r\n      this.$store.commit('resetPage');\r\n      this.getPosts(this.$store.state.page, true);\r\n      this.$router.push('/?tags=' + this.$store.getters.queryTags);\r\n    },\r\n    checkScrollingAndCallUpdate() {\r\n      var scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\r\n      if (\r\n        scrollTop + window.innerHeight >= document.body.clientHeight - this.scrollMargin &&\r\n        !this.isBusy &&\r\n        !this.reachingEnd\r\n      ) {\r\n        this.loadNextPage();\r\n        // this.reflowHandler();\r\n      }\r\n    },\r\n    loadNextPage() {\r\n      if (!this.isBusy) {\r\n        this.$store.commit('nextPage');\r\n        this.getPosts(this.$store.state.page, false);\r\n      }\r\n    },\r\n    getPosts(page = 1, refresh = false) {\r\n      if (this.reachingEnd) return -1;\r\n      if (refresh) this.$store.commit('resetImageArr');\r\n      this.$store.dispatch('getPosts', { refresh, rating: this.rating, callback: this.checkScrollingAndCallUpdate });\r\n    },\r\n    calcHeight(item) {\r\n      if (!item.isPageInd) return item.preview_height + 128;\r\n      else return 48;\r\n    },\r\n    updateHeight(args, item, index) {\r\n      // Here uses an undefined behavior (?) to get the arguments\r\n      // TODO: use defined behavior\\\r\n      let height = args[0];\r\n      this.$store.commit('commitRealHeight', { index, height });\r\n      // this.$refs.waterfall.$emit('reflow');\r\n      this.$forceUpdate();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import '../styles/_imports.scss';\r\n\r\n.header {\r\n  position: sticky;\r\n  top: 0px;\r\n  z-index: 800;\r\n}\r\n\r\n.title {\r\n  .favico {\r\n    display: inline;\r\n    margin: 0px;\r\n  }\r\n  p {\r\n    margin: 0px;\r\n  }\r\n  text-align: center;\r\n  font-family: $display-font;\r\n  color: $accent-pink;\r\n  font-size: 3rem;\r\n  padding: 3rem;\r\n}\r\n\r\n.page {\r\n  flex-direction: row;\r\n}\r\n.waterfall {\r\n  margin: auto 24px;\r\n  .wfslot {\r\n    transition: z-index 500ms cubic-bezier(0.47, 0, 0.745, 0.715);\r\n    &:hover {\r\n      z-index: 256;\r\n    }\r\n  }\r\n}\r\n\r\n// transitions\r\n\r\n.slide-fade-enter-active {\r\n  transition: all 150ms cubic-bezier(0.55, 0.055, 0.675, 0.19);\r\n}\r\n.slide-fade-leave-active {\r\n  transition: all 150ms cubic-bezier(0.215, 0.61, 0.355, 1);\r\n}\r\n.slide-fade-enter,\r\n.slide-fade-leave-to {\r\n  transform: translateY(16px);\r\n  opacity: 0;\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.move {\r\n  transition: all 250ms cubic-bezier(0.23, 1, 0.32, 1);\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// client/views/post.vue","function injectStyle (ssrContext) {\n  require(\"!!../../extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-09ced947\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../vue-loader/lib/selector?type=styles&index=0!./waterfall.vue\")\n}\nvar normalizeComponent = require(\"!../../vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../vue-loader/lib/selector?type=script&index=0!./waterfall.vue\"\n/* template */\nimport __vue_template__ from \"!!../../vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-09ced947\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../vue-loader/lib/selector?type=template&index=0!./waterfall.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-waterfall/lib/waterfall.vue\n// module id = 29\n// module chunks = 0","<template>\r\n  <div class=\"vue-waterfall\" :style=\"style\">\r\n    <slot></slot>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n.vue-waterfall {\r\n  position: relative;\r\n  /*overflow: hidden; cause clientWidth = 0 in IE if height not bigger than 0 */\r\n}\r\n</style>\r\n\r\n<script>\r\n\r\nconst MOVE_CLASS_PROP = '_wfMoveClass'\r\n\r\nexport default {\r\n  props: {\r\n    autoResize: {\r\n      default: true\r\n    },\r\n    interval: {\r\n      default: 200,\r\n      validator: (val) => val >= 0\r\n    },\r\n    align: {\r\n      default: 'left',\r\n      validator: (val) => ~['left', 'right', 'center'].indexOf(val)\r\n    },\r\n    line: {\r\n      default: 'v',\r\n      validator: (val) => ~['v', 'h'].indexOf(val)\r\n    },\r\n    lineGap: {\r\n      required: true,\r\n      validator: (val) => val >= 0\r\n    },\r\n    minLineGap: {\r\n      validator: (val) => val >= 0\r\n    },\r\n    maxLineGap: {\r\n      validator: (val) => val >= 0\r\n    },\r\n    singleMaxWidth: {\r\n      validator: (val) => val >= 0\r\n    },\r\n    fixedHeight: {\r\n      default: false\r\n    },\r\n    grow: {\r\n      validator: (val) => val instanceof Array\r\n    },\r\n    watch: {\r\n      default: () => ({})\r\n    }\r\n  },\r\n  data: () => ({\r\n    style: {\r\n      height: '',\r\n      overflow: ''\r\n    },\r\n    token: null\r\n  }),\r\n  methods: {\r\n    reflowHandler,\r\n    autoResizeHandler,\r\n    reflow\r\n  },\r\n  created () {\r\n    this.virtualRects = []\r\n    this.$on('reflow', () => {\r\n      this.reflowHandler()\r\n    })\r\n    this.$watch(() => (\r\n      this.align,\r\n      this.line,\r\n      this.lineGap,\r\n      this.minLineGap,\r\n      this.maxLineGap,\r\n      this.singleMaxWidth,\r\n      this.fixedHeight,\r\n      this.watch\r\n    ), this.reflowHandler)\r\n    this.$watch('grow', this.reflowHandler)\r\n  },\r\n  mounted () {\r\n    this.$watch('autoResize', this.autoResizeHandler)\r\n    on(this.$el, getTransitionEndEvent(), tidyUpAnimations, true)\r\n    this.autoResizeHandler(this.autoResize)\r\n  },\r\n  beforeDestroy () {\r\n    this.autoResizeHandler(false)\r\n    off(this.$el, getTransitionEndEvent(), tidyUpAnimations, true)\r\n  }\r\n}\r\n\r\nfunction autoResizeHandler (autoResize) {\r\n  if (autoResize === false || !this.autoResize) {\r\n    off(window, 'resize', this.reflowHandler, false)\r\n  } else {\r\n    on(window, 'resize', this.reflowHandler, false)\r\n  }\r\n}\r\n\r\nfunction tidyUpAnimations (event) {\r\n  let node = event.target\r\n  let moveClass = node[MOVE_CLASS_PROP]\r\n  if (moveClass) {\r\n    removeClass(node, moveClass)\r\n  }\r\n}\r\n\r\nfunction reflowHandler () {\r\n  clearTimeout(this.token)\r\n  this.token = setTimeout(this.reflow, this.interval)\r\n}\r\n\r\nfunction reflow () {\r\n  if (!this.$el) { return }\r\n  let width = this.$el.clientWidth\r\n  let metas = this.$children.map((slot) => slot.getMeta())\r\n  metas.sort((a, b) => a.order - b.order)\r\n  this.virtualRects = metas.map(() => ({}))\r\n  calculate(this, metas, this.virtualRects)\r\n  setTimeout(() => {\r\n    if (isScrollBarVisibilityChange(this.$el, width)) {\r\n      calculate(this, metas, this.virtualRects)\r\n    }\r\n    this.style.overflow = 'hidden'\r\n    render(this.virtualRects, metas)\r\n    this.$emit('reflowed', this)\r\n  }, 0)\r\n}\r\n\r\nfunction isScrollBarVisibilityChange (el, lastClientWidth) {\r\n  return lastClientWidth !== el.clientWidth\r\n}\r\n\r\nfunction calculate (vm, metas, styles) {\r\n  let options = getOptions(vm)\r\n  let processor = vm.line === 'h' ? horizontalLineProcessor : verticalLineProcessor\r\n  processor.calculate(vm, options, metas, styles)\r\n}\r\n\r\nfunction getOptions (vm) {\r\n  const maxLineGap = vm.maxLineGap ? +vm.maxLineGap : vm.lineGap\r\n  return {\r\n    align: ~['left', 'right', 'center'].indexOf(vm.align) ? vm.align : 'left',\r\n    line: ~['v', 'h'].indexOf(vm.line) ? vm.line : 'v',\r\n    lineGap: +vm.lineGap,\r\n    minLineGap: vm.minLineGap ? +vm.minLineGap : vm.lineGap,\r\n    maxLineGap: maxLineGap,\r\n    singleMaxWidth: Math.max(vm.singleMaxWidth || 0, maxLineGap),\r\n    fixedHeight: !!vm.fixedHeight,\r\n    grow: vm.grow && vm.grow.map(val => +val)\r\n  }\r\n}\r\n\r\nvar verticalLineProcessor = (() => {\r\n\r\n  function calculate (vm, options, metas, rects) {\r\n    let width = vm.$el.clientWidth\r\n    let grow = options.grow\r\n    let strategy = grow\r\n      ? getRowStrategyWithGrow(width, grow)\r\n      : getRowStrategy(width, options)\r\n    let tops = getArrayFillWith(0, strategy.count)\r\n    metas.forEach((meta, index) => {\r\n      let offset = tops.reduce((last, top, i) => top < tops[last] ? i : last, 0)\r\n      let width = strategy.width[offset % strategy.count]\r\n      let rect = rects[index]\r\n      rect.top = tops[offset]\r\n      rect.left = strategy.left + (offset ? sum(strategy.width.slice(0, offset)) : 0)\r\n      rect.width = width\r\n      rect.height = meta.height * (options.fixedHeight ? 1 : width / meta.width)\r\n      tops[offset] = tops[offset] + rect.height\r\n    })\r\n    vm.style.height = Math.max.apply(Math, tops) + 'px'\r\n  }\r\n\r\n  function getRowStrategy (width, options) {\r\n    let count = width / options.lineGap\r\n    let slotWidth\r\n    if (options.singleMaxWidth >= width) {\r\n      count = 1\r\n      slotWidth = Math.max(width, options.minLineGap)\r\n    } else {\r\n      let maxContentWidth = options.maxLineGap * ~~count\r\n      let minGreedyContentWidth = options.minLineGap * ~~(count + 1)\r\n      let canFit = maxContentWidth >= width\r\n      let canFitGreedy = minGreedyContentWidth <= width\r\n      if (canFit && canFitGreedy) {\r\n        count = Math.round(count)\r\n        slotWidth = width / count\r\n      } else if (canFit) {\r\n        count = ~~count\r\n        slotWidth = width / count\r\n      } else if (canFitGreedy) {\r\n        count = ~~(count + 1)\r\n        slotWidth = width / count\r\n      } else {\r\n        count = ~~count\r\n        slotWidth = options.maxLineGap\r\n      }\r\n      if (count === 1) {\r\n        slotWidth = Math.min(width, options.singleMaxWidth)\r\n        slotWidth = Math.max(slotWidth, options.minLineGap)\r\n      }\r\n    }\r\n    return {\r\n      width: getArrayFillWith(slotWidth, count),\r\n      count: count,\r\n      left: getLeft(width, slotWidth * count, options.align)\r\n    }\r\n  }\r\n\r\n  function getRowStrategyWithGrow (width, grow) {\r\n    let total = sum(grow)\r\n    return {\r\n      width: grow.map(val => width * val / total),\r\n      count: grow.length,\r\n      left: 0\r\n    }\r\n  }\r\n\r\n  return {\r\n    calculate\r\n  }\r\n\r\n})()\r\n\r\nvar horizontalLineProcessor = (() => {\r\n\r\n  function calculate (vm, options, metas, rects) {\r\n    let width = vm.$el.clientWidth\r\n    let total = metas.length\r\n    let top = 0\r\n    let offset = 0\r\n    while (offset < total) {\r\n      let strategy = getRowStrategy(width, options, metas, offset)\r\n      for (let i = 0, left = 0, meta, rect; i < strategy.count; i++) {\r\n        meta = metas[offset + i]\r\n        rect = rects[offset + i]\r\n        rect.top = top\r\n        rect.left = strategy.left + left\r\n        rect.width = meta.width * strategy.height / meta.height\r\n        rect.height = strategy.height\r\n        left += rect.width\r\n      }\r\n      offset += strategy.count\r\n      top += strategy.height\r\n    }\r\n    vm.style.height = top + 'px'\r\n  }\r\n\r\n  function getRowStrategy (width, options, metas, offset) {\r\n    let greedyCount = getGreedyCount(width, options.lineGap, metas, offset)\r\n    let lazyCount = Math.max(greedyCount - 1, 1)\r\n    let greedySize = getContentSize(width, options, metas, offset, greedyCount)\r\n    let lazySize = getContentSize(width, options, metas, offset, lazyCount)\r\n    let finalSize = chooseFinalSize(lazySize, greedySize, width)\r\n    let height = finalSize.height\r\n    let fitContentWidth = finalSize.width\r\n    if (finalSize.count === 1) {\r\n      fitContentWidth = Math.min(options.singleMaxWidth, width)\r\n      height = metas[offset].height * fitContentWidth / metas[offset].width\r\n    }\r\n    return {\r\n      left: getLeft(width, fitContentWidth, options.align),\r\n      count: finalSize.count,\r\n      height: height\r\n    }\r\n  }\r\n\r\n  function getGreedyCount (rowWidth, rowHeight, metas, offset) {\r\n    let count = 0\r\n    for (let i = offset, width = 0; i < metas.length && width <= rowWidth; i++) {\r\n      width += metas[i].width * rowHeight / metas[i].height\r\n      count++\r\n    }\r\n    return count\r\n  }\r\n\r\n  function getContentSize (rowWidth, options, metas, offset, count) {\r\n    let originWidth = 0\r\n    for (let i = count - 1; i >= 0; i--) {\r\n      let meta = metas[offset + i]\r\n      originWidth += meta.width * options.lineGap / meta.height\r\n    }\r\n    let fitHeight = options.lineGap * rowWidth / originWidth\r\n    let canFit = (fitHeight <= options.maxLineGap && fitHeight >= options.minLineGap)\r\n    if (canFit) {\r\n      return {\r\n        cost: Math.abs(options.lineGap - fitHeight),\r\n        count: count,\r\n        width: rowWidth,\r\n        height: fitHeight\r\n      }\r\n    } else {\r\n      let height = originWidth > rowWidth ? options.minLineGap : options.maxLineGap\r\n      return {\r\n        cost: Infinity,\r\n        count: count,\r\n        width: originWidth * height / options.lineGap,\r\n        height: height\r\n      }\r\n    }\r\n  }\r\n\r\n  function chooseFinalSize (lazySize, greedySize, rowWidth) {\r\n    if (lazySize.cost === Infinity && greedySize.cost === Infinity) {\r\n      return greedySize.width < rowWidth ? greedySize : lazySize\r\n    } else {\r\n      return greedySize.cost >= lazySize.cost ? lazySize : greedySize\r\n    }\r\n  }\r\n\r\n  return {\r\n    calculate\r\n  }\r\n\r\n})()\r\n\r\nfunction getLeft (width, contentWidth, align) {\r\n  switch (align) {\r\n    case 'right':\r\n      return width - contentWidth\r\n    case 'center':\r\n      return (width - contentWidth) / 2\r\n    default:\r\n      return 0\r\n  }\r\n}\r\n\r\nfunction sum (arr) {\r\n  return arr.reduce((sum, val) => sum + val)\r\n}\r\n\r\nfunction render (rects, metas) {\r\n  let metasNeedToMoveByTransform = metas.filter((meta) => meta.moveClass)\r\n  let firstRects = getRects(metasNeedToMoveByTransform)\r\n  applyRects(rects, metas)\r\n  let lastRects = getRects(metasNeedToMoveByTransform)\r\n  metasNeedToMoveByTransform.forEach((meta, i) => {\r\n    meta.node[MOVE_CLASS_PROP] = meta.moveClass\r\n    setTransform(meta.node, firstRects[i], lastRects[i])\r\n  })\r\n  document.body.clientWidth // forced reflow\r\n  metasNeedToMoveByTransform.forEach((meta) => {\r\n    addClass(meta.node, meta.moveClass)\r\n    clearTransform(meta.node)\r\n  })\r\n}\r\n\r\nfunction getRects (metas) {\r\n  return metas.map((meta) => meta.vm.rect)\r\n}\r\n\r\nfunction applyRects (rects, metas) {\r\n  rects.forEach((rect, i) => {\r\n    let style = metas[i].node.style\r\n    metas[i].vm.rect = rect\r\n    for (let prop in rect) {\r\n      style[prop] = rect[prop] + 'px'\r\n    }\r\n  })\r\n}\r\n\r\nfunction setTransform (node, firstRect, lastRect) {\r\n  let dx = firstRect.left - lastRect.left\r\n  let dy = firstRect.top - lastRect.top\r\n  let sw = firstRect.width / lastRect.width\r\n  let sh = firstRect.height / lastRect.height\r\n  node.style.transform =\r\n  node.style.WebkitTransform = `translate(${dx}px,${dy}px) scale(${sw},${sh})`\r\n  node.style.transitionDuration = '0s'\r\n}\r\n\r\nfunction clearTransform (node) {\r\n  node.style.transform = node.style.WebkitTransform = ''\r\n  node.style.transitionDuration = ''\r\n}\r\n\r\nfunction getTransitionEndEvent () {\r\n  let isWebkitTrans =\r\n    window.ontransitionend === undefined &&\r\n    window.onwebkittransitionend !== undefined\r\n  let transitionEndEvent = isWebkitTrans\r\n    ? 'webkitTransitionEnd'\r\n    : 'transitionend'\r\n  return transitionEndEvent\r\n}\r\n\r\n/**\r\n * util\r\n */\r\n\r\nfunction getArrayFillWith (item, count) {\r\n  let getter = (typeof item === 'function') ? () => item() : () => item\r\n  let arr = []\r\n  for (let i = 0; i < count; i++) {\r\n    arr[i] = getter()\r\n  }\r\n  return arr\r\n}\r\n\r\nfunction addClass (elem, name) {\r\n  if (!hasClass(elem, name)) {\r\n    let cur = attr(elem, 'class').trim()\r\n    let res = (cur + ' ' + name).trim()\r\n    attr(elem, 'class', res)\r\n  }\r\n}\r\n\r\nfunction removeClass (elem, name) {\r\n  let reg = new RegExp('\\\\s*\\\\b' + name + '\\\\b\\\\s*', 'g')\r\n  let res = attr(elem, 'class').replace(reg, ' ').trim()\r\n  attr(elem, 'class', res)\r\n}\r\n\r\nfunction hasClass (elem, name) {\r\n  return (new RegExp('\\\\b' + name + '\\\\b')).test(attr(elem, 'class'))\r\n}\r\n\r\nfunction attr (elem, name, value) {\r\n  if (typeof value !== 'undefined') {\r\n    elem.setAttribute(name, value)\r\n  } else {\r\n    return elem.getAttribute(name) || ''\r\n  }\r\n}\r\n\r\nfunction on (elem, type, listener, useCapture = false) {\r\n  elem.addEventListener(type, listener, useCapture)\r\n}\r\n\r\nfunction off (elem, type, listener, useCapture = false) {\r\n  elem.removeEventListener(type, listener, useCapture)\r\n}\r\n\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// node_modules/vue-waterfall/lib/waterfall.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"vue-waterfall\",style:(_vm.style)},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-09ced947\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vue-waterfall/lib/waterfall.vue\n// module id = 32\n// module chunks = 0","function injectStyle (ssrContext) {\n  require(\"!!../../extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1b429f74\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../vue-loader/lib/selector?type=styles&index=0!./waterfall-slot.vue\")\n}\nvar normalizeComponent = require(\"!../../vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../vue-loader/lib/selector?type=script&index=0!./waterfall-slot.vue\"\n/* template */\nimport __vue_template__ from \"!!../../vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1b429f74\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../vue-loader/lib/selector?type=template&index=0!./waterfall-slot.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-waterfall/lib/waterfall-slot.vue\n// module id = 33\n// module chunks = 0","<template>\n  <div class=\"vue-waterfall-slot\" v-show=\"isShow\">\n    <slot></slot>\n  </div>\n</template>\n\n<style>\n.vue-waterfall-slot {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n}\n</style>\n\n<script>\n\nexport default {\n  data: () => ({\n    isShow: false\n  }),\n  props: {\n    width: {\n      required: true,\n      validator: (val) => val >= 0\n    },\n    height: {\n      required: true,\n      validator: (val) => val >= 0\n    },\n    order: {\n      default: 0\n    },\n    moveClass: {\n      default: ''\n    }\n  },\n  methods: {\n    notify () {\n      this.$parent.$emit('reflow', this)\n    },\n    getMeta () {\n      return {\n        vm: this,\n        node: this.$el,\n        order: this.order,\n        width: this.width,\n        height: this.height,\n        moveClass: this.moveClass\n      }\n    }\n  },\n  created () {\n    this.rect = {\n      top: 0,\n      left: 0,\n      width: 0,\n      height: 0\n    }\n    this.$watch(() => (\n      this.width,\n      this.height\n    ), this.notify)\n  },\n  mounted () {\n    this.$parent.$once('reflowed', () => {\n      this.isShow = true\n    })\n    this.notify()\n  },\n  destroyed () {\n    this.notify()\n  }\n}\n\n</script>\n\n\n\n// WEBPACK FOOTER //\n// node_modules/vue-waterfall/lib/waterfall-slot.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShow),expression:\"isShow\"}],staticClass:\"vue-waterfall-slot\"},[_vm._t(\"default\")],2)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1b429f74\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vue-waterfall/lib/waterfall-slot.vue\n// module id = 36\n// module chunks = 0","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e1d6dc74\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./waterfallImage.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./waterfallImage.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e1d6dc74\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./waterfallImage.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-e1d6dc74\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/components/waterfallImage.vue\n// module id = 37\n// module chunks = 0","<template>\r\n<transition appear name=\"slide-fade\">\r\n  <div class=\"wf-wrapper\" ref=\"wrapper\" @mouseover=\"onHover\" @mouseout=\"onHoverOff\">\r\n    <div v-if=\"isPageInd\">\r\n      <div class=\"wf-pageindicator\">\r\n        Page {{page}}\r\n      </div>\r\n    </div>\r\n    <div v-else>\r\n      <div class=\"wfimg-container\">\r\n        <router-link :to=\"'/'+id\"\r\n        >\r\n        <!-- target=\"_blank\" -->\r\n          <transition name=\"placeholder-fade-away\">\r\n            <div class=\"placeholder\" v-if=\"~loaded\" :style=\"placeholderStyle\"></div>\r\n          </transition>\r\n          <img :src=\"preview_url\" :alt=\"id\" class=\"wfimg\"\r\n          @loadend=\"recalculateHeight\">\r\n        </router-link>\r\n      </div>\r\n      <div class=\"wfdesc\">\r\n        <div class=\"wfdesc-row\">\r\n          <div class=\"wfdesc-resolution\" @click=\"loaded=false\">{{width}} x {{height}}</div>\r\n          <!-- <div class=\"button\"><img src=\"\" alt=\"\" class=\"dl\"></div> -->\r\n          </div>\r\n        <div class=\"wfdesc-row\"><span class=\"wfdesc-author\">uploaded by {{author}}</span></div>\r\n      </div>\r\n      <transition name=\"slide-fade\">\r\n      <div class=\"wfextra\" v-if=\"hover\">\r\n        <div class=\"wfextra-tags\">\r\n          <div class=\"tag\" v-for=\"tag in tagsArr\"><span class=\"tag-hash\">#</span>{{tag}}</div>\r\n        </div>\r\n      </div>\r\n      </transition>\r\n    </div>\r\n  </div>\r\n</transition>\r\n\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'waterfallImage',\r\n  props: {\r\n    id: Number,\r\n    tags: String,\r\n    author: String,\r\n    created_at: Number,\r\n    source: String,\r\n    score: Number,\r\n    file_size: Number,\r\n    file_url: String,\r\n    width: Number,\r\n    height: Number,\r\n    preview_url: String,\r\n    actual_preview_width: Number,\r\n    actual_preview_height: Number,\r\n    sample_url: String,\r\n    sample_width: Number,\r\n    sample_height: Number,\r\n    sample_file_size: Number,\r\n    jpeg_url: String,\r\n    jpeg_file_size: Number,\r\n    rating: String,\r\n    isPageInd: { type: Boolean, default: false },\r\n    page: Number\r\n\r\n    /*\r\n    \"rating\": \"s\",\r\n    \"has_children\": false,\r\n    \"parent_id\": null,\r\n    \"status\": \"active\",\r\n    \"width\": 2976,\r\n    \"height\": 1881,\r\n    \"is_held\": false,\r\n    \"frames_pending_string\": \"\",\r\n    \"frames_pending\": [],\r\n    \"frames_string\": \"\",\r\n    \"frames\": [] */\r\n  },\r\n  methods: {\r\n    onHover() {\r\n      if (this.loaded) this.hover = true;\r\n    },\r\n    onHoverOff() {\r\n      this.hover = false;\r\n    },\r\n    recalculateHeight(event) {\r\n      let height;\r\n      height = this.$refs.wrapper.offsetHeight;\r\n      if (height != 0) {\r\n        console.log(`#${this.id} loaded!`);\r\n        this.loaded = true;\r\n        this.$emit('height-change', height);\r\n      }\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      loaded: false,\r\n      hover: false,\r\n      placeholderStyle: {}\r\n    };\r\n  },\r\n  computed: {\r\n    // placeholderStyle() {\r\n    //   return\r\n    // },\r\n    tagsArr() {\r\n      return this.tags.split(' ');\r\n    }\r\n  },\r\n  created() {\r\n    if (this.isPageInd) {\r\n      // TODO: Replace router.currentRoute.query.page with current page\r\n      //   document.addEventListener('scroll', () => {\r\n      //           let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\r\n      //   if (scrollTop + window.innerHeight >= this.$root.top && router.currentRoute.query.page) {\r\n      //     router.currentRoute.query.page=this.page\r\n      //   }\r\n      //   });\r\n    }\r\n  },\r\n  mounted() {\r\n    this.$nextTick(() => {\r\n      let height = Math.ceil(\r\n        parseInt(window.getComputedStyle(this.$refs.wrapper, null)['width']) * (this.sample_height / this.sample_width)\r\n      );\r\n      console.log(height, window.getComputedStyle(this.$refs.wrapper, null)['width']);\r\n      let style = {\r\n        height: height + 'px',\r\n        marginBottom: -height + 'px'\r\n      };\r\n      this.placeholderStyle = style;\r\n      console.log(`#${this.id} placeholder drawn!`);\r\n    });\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../styles/_imports.scss';\r\n\r\n.wf-wrapper {\r\n  margin: 8px;\r\n  background: #fff;\r\n  overflow: hidden;\r\n  border-radius: 4px;\r\n  transition: all 200ms cubic-bezier(0.165, 0.84, 0.44, 1);\r\n  box-shadow: 0px 1px 1.5px rgba(56, 27, 27, 0.24);\r\n  font-family: $text-font;\r\n  &:hover {\r\n    box-shadow: 0px 6px 16px rgba(0, 0, 0, 0.24);\r\n    z-index: 256;\r\n  }\r\n}\r\n\r\n.wfimg-container {\r\n  max-width: 300px;\r\n  overflow: hidden;\r\n}\r\n\r\n.wfimg {\r\n  width: 100%;\r\n}\r\n\r\n.wf-pageindicator {\r\n  background: $accent-pink;\r\n  color: map-get($greys, 50);\r\n  font-family: $display-font;\r\n  // font-weight: bold;\r\n  padding: 0.25rem 0.5rem;\r\n}\r\n\r\n.wfdesc-row,\r\n.wfdesc-row > * {\r\n  margin: 0px;\r\n  padding: 0px;\r\n}\r\n\r\n.wfdesc,\r\n.wfextra {\r\n  padding: 0.25rem 0.5rem 0.5rem 0.5rem;\r\n}\r\n\r\n.wfdesc-resolution {\r\n  font-weight: bold;\r\n  color: map-get($greys, 500);\r\n}\r\n.wfdesc-author {\r\n  font-size: 0.75rem;\r\n  color: map-get($greys, 300);\r\n}\r\n\r\n.wfextra {\r\n  display: block;\r\n  .wfextra-tags {\r\n    display: flex;\r\n    font-size: 0.75rem;\r\n    font-weight: bold;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    // font-family: $display-font;\r\n    color: map-get($greys, 700);\r\n    .tag {\r\n      margin: 0.15rem 0.2rem;\r\n      padding: 0.1rem 0.3rem;\r\n      background: map-get($greys, 50);\r\n      color: map-get($greys, 300);\r\n      border-radius: 0.2rem;\r\n      .tag-hash {\r\n        color: map-get($greys, 100);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n@keyframes loadingAnim {\r\n  0% {\r\n    background: mix(map-get($greys, 50), map-get($greys, 100));\r\n  }\r\n  100% {\r\n    background: map-get($greys, 100);\r\n  }\r\n}\r\n\r\n.placeholder {\r\n  width: 100%;\r\n  position: relative;\r\n  z-index: 80;\r\n  animation: loadingAnim 500ms cubic-bezier(0.445, 0.05, 0.55, 0.95) 0s infinite alternate;\r\n}\r\n\r\n// transitions\r\n\r\n.placeholder-fade-away-leave-active {\r\n  transition: all 150ms cubic-bezier(0.165, 0.84, 0.44, 1);\r\n}\r\n.placeholder-fade-away-leave-to {\r\n  opacity: 0;\r\n}\r\n\r\n.slide-fade-enter-active {\r\n  transition: all 150ms cubic-bezier(0.55, 0.055, 0.675, 0.19);\r\n}\r\n.slide-fade-leave-active {\r\n  transition: all 150ms cubic-bezier(0.215, 0.61, 0.355, 1);\r\n}\r\n.slide-fade-enter,\r\n.slide-fade-leave-to {\r\n  transform: translateY(16px);\r\n  opacity: 0;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// client/components/waterfallImage.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('transition',{attrs:{\"appear\":\"\",\"name\":\"slide-fade\"}},[_c('div',{ref:\"wrapper\",staticClass:\"wf-wrapper\",on:{\"mouseover\":_vm.onHover,\"mouseout\":_vm.onHoverOff}},[(_vm.isPageInd)?_c('div',[_c('div',{staticClass:\"wf-pageindicator\"},[_vm._v(\"\\r\\n        Page \"+_vm._s(_vm.page)+\"\\r\\n      \")])]):_c('div',[_c('div',{staticClass:\"wfimg-container\"},[_c('router-link',{attrs:{\"to\":'/'+_vm.id}},[_c('transition',{attrs:{\"name\":\"placeholder-fade-away\"}},[(~_vm.loaded)?_c('div',{staticClass:\"placeholder\",style:(_vm.placeholderStyle)}):_vm._e()]),_vm._v(\" \"),_c('img',{staticClass:\"wfimg\",attrs:{\"src\":_vm.preview_url,\"alt\":_vm.id},on:{\"loadend\":_vm.recalculateHeight}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"wfdesc\"},[_c('div',{staticClass:\"wfdesc-row\"},[_c('div',{staticClass:\"wfdesc-resolution\",on:{\"click\":function($event){_vm.loaded=false}}},[_vm._v(_vm._s(_vm.width)+\" x \"+_vm._s(_vm.height))])]),_vm._v(\" \"),_c('div',{staticClass:\"wfdesc-row\"},[_c('span',{staticClass:\"wfdesc-author\"},[_vm._v(\"uploaded by \"+_vm._s(_vm.author))])])]),_vm._v(\" \"),_c('transition',{attrs:{\"name\":\"slide-fade\"}},[(_vm.hover)?_c('div',{staticClass:\"wfextra\"},[_c('div',{staticClass:\"wfextra-tags\"},_vm._l((_vm.tagsArr),function(tag){return _c('div',{staticClass:\"tag\"},[_c('span',{staticClass:\"tag-hash\"},[_vm._v(\"#\")]),_vm._v(_vm._s(tag))])}))]):_vm._e()])],1)])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-e1d6dc74\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/components/waterfallImage.vue\n// module id = 40\n// module chunks = 0","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper\"},[(!_vm.tags.length)?_c('div',{staticClass:\"title\"},[_c('img',{staticClass:\"favico\",attrs:{\"src\":\"/icon/icon.png\",\"alt\":\"\"}}),_vm._v(\" \"),_c('p',[_vm._v(\"konamirr\")])]):_vm._e(),_vm._v(\" \"),_c('headerbar',{staticClass:\"header\",attrs:{\"query\":_vm.startTags,\"ratingFlag\":_vm.rating},on:{\"querySubmission\":_vm.querySubmission}}),_vm._v(\" \"),_c('div',{staticClass:\"page\"},[(_vm.notError)?_c('waterfall',{ref:\"waterfall\",staticClass:\"waterfall\",attrs:{\"line-gap\":256,\"watch\":_vm.imgsArr,\"align\":\"center\"}},_vm._l((_vm.imgsArr),function(item,index){return _c('waterfall-slot',{key:index,staticClass:\"wfslot\",attrs:{\"width\":240,\"height\":item.realHeight||_vm.calcHeight(item),\"order\":index,\"move-class\":\"move\"}},[_c('waterfall-image',_vm._b({attrs:{\"move-class\":\"move\"},on:{\"height-change\":function($event){_vm.updateHeight(arguments, item, index)}}},'waterfall-image',item,false))],1)})):_c('div',{staticClass:\"errorMsg\"})],1),_vm._v(\" \"),_c('div',{staticClass:\"loader-wrapper\"},[(_vm.isBusy)?_c('div',{staticClass:\"loading\"},[_vm._v(\"\\r\\n      loading next page...\\r\\n    \")]):(!_vm.reachingEnd)?_c('div',{staticClass:\"loadnext\"},[_c('button',{on:{\"click\":_vm.loadNextPage}},[_vm._v(\"load the next page\")])]):_c('div',{staticClass:\"reaching-end\"},[_vm._v(\"\\r\\n      Nothing more to show.\\r\\n    \")])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-f93712e6\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/views/post.vue\n// module id = 41\n// module chunks = 0","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-401025be\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?sourceMap!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./image.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./image.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-401025be\\\",\\\"hasScoped\\\":true,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./image.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-401025be\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/views/image.vue\n// module id = 42\n// module chunks = 0","<template>\r\n  <div class=\"page\">\r\n    <div class=\"img-desc-wrapper\">\r\n      <div class=\"image-wrapper\">\r\n        <img class=\"image\" :src=\"imageInfo.jpeg_url\" :alt=\"imageInfo.tags?imageInfo.tags:''\">\r\n        <!-- Use a canvas here to achieve dynamic loading! -->\r\n      </div>\r\n      <div class=\"desc\">\r\n        <div class=\"title-id\">\r\n          # {{id}}\r\n        </div>\r\n        <div class=\"tags\">\r\n          <div class=\"tag\" v-for=\"(tag,index) in tagsArr\" :key=\"index\"><span class=\"tag-hash\"># </span>{{tag.replace('_', ' ')}}</div>\r\n        </div>\r\n        <div class=\"download\">\r\n          <p>\r\n            * Please use right-click download for the following links\r\n          </p>\r\n          <a :href=\"imageInfo.file_url\" class=\"download-link\" download>Download Original picture ({{(imageInfo.file_size/1048576).toFixed(2)}}MiB)</a>\r\n          <a v-if=\"hasJpegVariant\" :href=\"imageInfo.jpeg_url\" class=\"download-link\" download>Download JPEG Variant ({{(imageInfo.jpeg_file_size/1048576).toFixed(2)}}MiB)</a>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"comments\">\r\n      <div class=\"comment\" v-for=\"(comment, index) in comments\" :key=\"index\">\r\n        {{comment.creator}}:<br> {{comment.body}}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _ from 'lodash';\r\nimport config from '../config.js';\r\n\r\nexport default {\r\n  name: 'image',\r\n  props: {\r\n    id: Number\r\n  },\r\n  created() {\r\n    // fetch image and comment\r\n    this.updateData();\r\n  },\r\n  data() {\r\n    return {\r\n      imageInfo: new Object(),\r\n      comments: new Array()\r\n    };\r\n  },\r\n  watch: {\r\n    $route(to, from) {\r\n      if (!/\\/\\d+/.test(from)) this.updateData();\r\n    }\r\n  },\r\n  computed: {\r\n    tagsArr() {\r\n      return this.imageInfo.tags ? this.imageInfo.tags.split(' ') : [];\r\n    },\r\n    hasJpegVariant() {\r\n      return !/(\\.jpg|\\.jpeg)/i.test(this.imageInfo.file_url);\r\n    }\r\n  },\r\n  methods: {\r\n    fetchImageData() {\r\n      let request = new XMLHttpRequest();\r\n      request.onreadystatechange = () => {\r\n        if (request.readyState === XMLHttpRequest.DONE) {\r\n          if (request.status === 200) {\r\n            let responseObject = JSON.parse(request.responseText);\r\n            console.log(responseObject);\r\n            if (!!responseObject[0]) this.imageInfo = _.assign({}, this.imageInfo, responseObject[0]);\r\n            // else this.$router.replace('/e/404');\r\n            // console.log(this.imageInfo);\r\n            // this.infoLoaded();58537537\r\n          } else if (request.status >= 400) {\r\n            // Error! show error information\r\n            console.log(`Error: HTTP ${request.status}`);\r\n            // this.$router.replace('/e/404');\r\n          }\r\n        }\r\n      };\r\n      // let requestURI = `https://konachan.kcsl.ink/kona-api/post.json?tags=id:${this.id}`;\r\n      let requestURI = config.methods.getImageURI({ id: this.id });\r\n      request.open('GET', requestURI);\r\n      request.send();\r\n      console.log('Request sent!', requestURI);\r\n    },\r\n    fetchCommentData() {\r\n      let request = new XMLHttpRequest();\r\n      request.onreadystatechange = () => {\r\n        if (request.readyState === XMLHttpRequest.DONE) {\r\n          if (request.status === 200) {\r\n            let responseObject = JSON.parse(request.responseText);\r\n            this.comments = responseObject;\r\n            // this.infoLoaded();\r\n          } else if (request.status >= 400) {\r\n            // Error! show error information\r\n            console.log(`Error: HTTP ${request.status}`);\r\n            // this.$router.replace('/e/404');\r\n          }\r\n        }\r\n      };\r\n      // let requestURI = `https://konachan.kcsl.ink/kona-api/comment.json?post_id=${this.id}`;\r\n      let requestURI = config.methods.getCommentURI({ id: this.id });\r\n      request.open('GET', requestURI);\r\n      request.send();\r\n      console.log('Request sent!', requestURI);\r\n    },\r\n    updateData() {\r\n      this.fetchImageData();\r\n      this.fetchCommentData();\r\n    },\r\n    regulateComment(comment) {}\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../styles/_imports.scss';\r\n\r\n.page {\r\n  background: map-get($greys, 0);\r\n  // padding: 1rem;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin: 24px auto;\r\n  @media screen and(min-width: 720px) and (max-width: 1440px) {\r\n    box-shadow: 0px 6px 16px rgba(0, 0, 0, 0.24);\r\n    max-width: 960px;\r\n  }\r\n  @media screen and (min-width: 1440px) {\r\n    box-shadow: 0px 6px 16px rgba(0, 0, 0, 0.24);\r\n    max-width: 1280px;\r\n  }\r\n  .img-desc-wrapper {\r\n    display: flex;\r\n    @media screen and (max-width: 720px) {\r\n      // Phone\r\n      flex-direction: column;\r\n    }\r\n    @media screen and(min-width: 720px) and (max-width: 1440px) {\r\n      flex-direction: column;\r\n      .desc {\r\n        margin: 1rem 2rem;\r\n      }\r\n    }\r\n    @media screen and (min-width: 1440px) {\r\n      flex-direction: row;\r\n      .desc {\r\n        width: 240px;\r\n        flex-shrink: 0;\r\n        flex-grow: 0;\r\n        margin: 1rem 1.5rem;\r\n      }\r\n    }\r\n    .image-wrapper {\r\n      .image {\r\n        max-width: 100%;\r\n      }\r\n    }\r\n  }\r\n}\r\n.desc {\r\n  font-family: $display-font;\r\n  .title-id {\r\n    font-size: 2rem;\r\n    color: map-get($greys, 500);\r\n    margin-bottom: 1rem;\r\n  }\r\n  .tags {\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    // font-family: $display-font;\r\n    color: map-get($greys, 700);\r\n    .tag {\r\n      margin: 0.25rem 0.3rem;\r\n      padding: 0.2rem 0.5rem;\r\n      background: mix(map-get($greys, 100), map-get($greys, 50));\r\n      border-radius: 0.2rem;\r\n      .tag-hash {\r\n        color: map-get($greys, 300);\r\n      }\r\n    }\r\n  }\r\n  .download {\r\n    margin-top: 1rem;\r\n    margin-bottom: 1rem;\r\n    .download-link {\r\n      display: block;\r\n      margin-top: 0.5rem;\r\n      margin-bottom: 0.5rem;\r\n      font-size: 1.25rem;\r\n    }\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// client/views/image.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"img-desc-wrapper\"},[_c('div',{staticClass:\"image-wrapper\"},[_c('img',{staticClass:\"image\",attrs:{\"src\":_vm.imageInfo.jpeg_url,\"alt\":_vm.imageInfo.tags?_vm.imageInfo.tags:''}})]),_vm._v(\" \"),_c('div',{staticClass:\"desc\"},[_c('div',{staticClass:\"title-id\"},[_vm._v(\"\\n        # \"+_vm._s(_vm.id)+\"\\n      \")]),_vm._v(\" \"),_c('div',{staticClass:\"tags\"},_vm._l((_vm.tagsArr),function(tag,index){return _c('div',{key:index,staticClass:\"tag\"},[_c('span',{staticClass:\"tag-hash\"},[_vm._v(\"# \")]),_vm._v(_vm._s(tag.replace('_', ' ')))])})),_vm._v(\" \"),_c('div',{staticClass:\"download\"},[_c('p',[_vm._v(\"\\n          * Please use right-click download for the following links\\n        \")]),_vm._v(\" \"),_c('a',{staticClass:\"download-link\",attrs:{\"href\":_vm.imageInfo.file_url,\"download\":\"\"}},[_vm._v(\"Download Original picture (\"+_vm._s((_vm.imageInfo.file_size/1048576).toFixed(2))+\"MiB)\")]),_vm._v(\" \"),(_vm.hasJpegVariant)?_c('a',{staticClass:\"download-link\",attrs:{\"href\":_vm.imageInfo.jpeg_url,\"download\":\"\"}},[_vm._v(\"Download JPEG Variant (\"+_vm._s((_vm.imageInfo.jpeg_file_size/1048576).toFixed(2))+\"MiB)\")]):_vm._e()])])]),_vm._v(\" \"),_c('div',{staticClass:\"comments\"},_vm._l((_vm.comments),function(comment,index){return _c('div',{key:index,staticClass:\"comment\"},[_vm._v(\"\\n      \"+_vm._s(comment.creator)+\":\"),_c('br'),_vm._v(\" \"+_vm._s(comment.body)+\"\\n    \")])}))])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-401025be\",\"hasScoped\":true,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/views/image.vue\n// module id = 45\n// module chunks = 0","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap&-autoprefixer!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-efe7a02a\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./error.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./error.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-efe7a02a\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./error.vue\"\n/* template functional */\n  var __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./client/views/error.vue\n// module id = 46\n// module chunks = 0","<template>\r\n<div class=\"page\">\r\n  \r\n  ERROR: {{number}}\r\n</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'errorPage',\r\n  props: ['number']\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// client/views/error.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_vm._v(\"\\r\\n  \\r\\n  ERROR: \"+_vm._s(_vm.number)+\"\\r\\n\")])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-efe7a02a\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./client/views/error.vue\n// module id = 49\n// module chunks = 0","import Vue from 'vue'\nimport Vuex from 'vuex'\nimport config from \"../config.js\"\n\nVue.use(Vuex)\n\nconst state = {\n  imgsArr: [],\n  tags: [],\n  page: 1,\n  errorState: false,\n  errorMsg: \"\",\n  reachingEnd: false,\n  busyState: false,\n  scrollPosition: 0\n}\n\nconst mutations = {\n  resetImageArr(state) { state.imgsArr = [] },\n  appendImageArr(state, newArr) {\n    state.imgsArr.push.apply(state.imgsArr, newArr);\n  },\n  setPage(state, page) {\n    state.page = page\n  },\n  nextPage(state) { state.page++ },\n  resetPage(state) { state.page = 1 }, setTags(state, tagsArr) {\n    state.tags = tagsArr;\n  },\n  commitRealHeight(state, { index, height }) {\n    Vue.set(state.imgsArr[index], 'realHeight', height)\n  },\n  resetStates(state) {\n    state.errorState = false\n    state.reachingEnd = false\n  },\n  recvError(state, errorMsg) {\n    state.errorState = true\n    state.errorMsg = errorMsg\n    state.reachingEnd = true\n  },\n  reachEnd(state) {\n    state.reachingEnd = true\n  },\n  setBusy(state, busy) {\n    state.busyState = busy\n  },\n  setScroll(state, scroll) {\n    state.scrollPosition = scroll\n  }\n}\n\nconst actions = {\n  getPosts(context, { nextPage = false, refresh = false, rating = 's', callback = null, callbackArgs = null }) {\n    if (context.state.isBusy == true) return\n    if (nextPage) context.commit('nextPage')\n    context.commit('setBusy', true)\n    let page = state.page\n    let request = new XMLHttpRequest();\n    request.onreadystatechange = () => {\n      if (request.readyState === XMLHttpRequest.DONE) {\n        if (request.status === 200) {\n          let responseObject = JSON.parse(request.responseText);\n          if (responseObject.length == 0 || responseObject.success == false) {\n            // Empty response! Either nothing have been found,\n            // or already reaching the end.\n            // this.reachingEnd = true;\n            context.commit('reachEnd')\n            // window.removeEventListener('scroll', this.checkScrollingAndCallUpdate);\n            console.log('Nothing more to show.');\n          } else {\n            if (rating == 's')\n              _.remove(responseObject, v => {\n                return v.rating != 's';\n              });\n            // Success! append retrieved data after current data array\n            // this.imgsArr.push({\n            //   isPageInd: true,\n            //   page: this.page\n            // });\n            // this.imgsArr.push.apply(this.imgsArr, responseObject);\n            // console.log(this.imgsArr);\n            responseObject.unshift({\n              isPageInd: true,\n              page\n            });\n            context.commit('appendImageArr', responseObject);\n            if (callback) callback(...callbackArgs)\n          }\n          // this.notError = true;\n        } else if (request.status >= 400) {\n          // Error! show error information,n\n          console.log(`Error: HTTP ${request.status}`);\n          // console.log(request.responseText);\n          // this.notError = false;\n          let errorMsg = JSON.parse(request.responseText).reason;\n          context.commit('recvError', errorMsg)\n        }\n      }\n      context.commit('setBusy', false)\n    };\n    // let requestURI = `https://konachan.kcsl.ink/kona-api/post.json?tags=${context.getters.queryTags}&page=${context.state.page}`;\n    let requestURI = config.methods.getPostListURI({ tags: context.getters.queryTags, page: context.state.page })\n    request.open('GET', requestURI);\n    request.send();\n    console.log('Request sent!', requestURI);\n  }\n}\n\nconst getters = {\n  queryTags(state) {\n    return state.tags ? state.tags.join('+') : '';\n  }\n}\n\nconst store = new Vuex.Store({\n  state,\n  mutations,\n  getters,\n  actions\n})\n\nexport default store\n\n\n\n// WEBPACK FOOTER //\n// ./client/store/index.js","import runtime from 'offline-plugin/runtime'\n\nruntime.install({\n  // When an update is ready, tell ServiceWorker to take control immediately:\n  onUpdateReady () {\n    console.log('update ready')\n    runtime.applyUpdate()\n  },\n\n  // Reload to get the new version:\n  onUpdated () {\n    console.log('updated')\n    location.reload()\n  }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./client/pwa.js"],"sourceRoot":""}